"use strict";
function e(e) {
  return e && "object" == typeof e && "default" in e ? e.default : e;
}
Object.defineProperty(exports, "__esModule", { value: !0 });
var t = require("react"),
  n = e(t),
  i = e(require("antd/lib/message")),
  o = require("nanoid"),
  r = e(require("deepcopy")),
  a = e(require("antd/lib/button")),
  c = require("react-dom"),
  s = e(c),
  l = e(require("classnames")),
  u = require("@ant-design/icons"),
  f = e(require("antd/lib/popconfirm")),
  d = require("react-sortable-hoc"),
  m = require("react-intl"),
  g = e(require("antd/lib/menu")),
  p = e(require("antd/lib/input")),
  h = e(require("antd/lib/checkbox")),
  v = e(require("antd/lib/switch")),
  y = e(require("antd/lib/input-number")),
  x = e(require("antd/lib/col")),
  b = e(require("antd/lib/row")),
  w = e(require("antd/lib/tabs")),
  M = require("react-color"),
  E = e(require("antd/lib/list")),
  C = e(require("antd/lib/modal")),
  S = e(require("antd/lib/form")),
  k = e(require("antd/lib/select")),
  D = e(require("antd/lib/radio")),
  N = e(require("antd/lib/table")),
  I = e(require("antd/lib/space")),
  L = e(require("antd/lib/typography")),
  F = ["modalMask"],
  R = ["_inner"];
function _(e) {
  return r(e);
}
function O(e) {
  void 0 === e && (e = "");
  var t = { r: 0, g: 0, b: 0, a: 0 };
  return (
    e.replace(
      /rgba\(\s*?(\d+)\s*?,\s*?(\d+)\s*?,\s*?(\d+)\s*?,\s*?(\d+)\s*?\)/g,
      function (n, i, o, r, a) {
        return (t = { r: i, g: o, b: r, a: a }), e;
      }
    ),
    t
  );
}
function A(e) {
  return e ? e + "-" + o.nanoid() : o.nanoid();
}
var X = function () {
    return !!/macintosh|mac os x/i.test(navigator.userAgent);
  },
  T = function (e, t, n) {
    return (e = [].concat(e)), Y(e, t, n), e;
  },
  j = function (e, t) {
    return t < 0 ? e + t : t;
  },
  Y = function (e, t, n) {
    var i = e.length,
      o = j(i, t);
    if (o >= 0 && o < i) {
      var r = j(i, n),
        a = e.splice(t, 1);
      e.splice(r, 0, a[0]);
    }
  };
function P(e, t, n) {
  void 0 === n && (n = "yh-container-iframe");
  var i,
    o = "#" + n,
    r = document.querySelector(o);
  r
    ? null == (i = r.contentWindow) || i.postMessage(e, t)
    : console.warn("can not find iframe " + o);
}
function U(e) {
  return (e * Math.PI) / 180;
}
function z() {
  var e = document.querySelector("#yh-container");
  return e || (e = document.querySelector("#yh-container-iframe")), e;
}
function q(e, t, n, i) {
  for (var o = 0, r = t.length - 1; o <= r; ) {
    var a = parseInt(o + (r - o) / 2 + "");
    if (e === t[a][n] || Math.abs(e - t[a][n]) < i)
      return [t[a], Math.abs(e - t[a][n])];
    e > t[a][n] ? (o = a + 1) : (r = a - 1);
  }
  return null;
}
function B(e, n, i, o) {
  var r = n.getStore(),
    a = t.useMemo(
      function () {
        return (
          (n.iframeId = o || n.iframeId),
          (n.iframeOrigin = e),
          function () {
            P(
              {
                store: r.getData(),
                scaleState: n.getScaleState(),
                wrapperState: n.getWrapperMove().iframe,
              },
              e,
              o
            );
          }
        );
      },
      [n, e, r, o]
    );
  return (
    t.useEffect(
      function () {
        var e = function () {};
        return (
          i &&
            ((n.refreshIframe = a),
            (e = r.subscribe(function () {
              a();
            }))),
          function () {
            e();
          }
        );
      },
      [n.refreshIframe, a, i, r]
    ),
    [a]
  );
}
function G(e, t, n, i, o, r, a) {
  try {
    var c = e[r](a),
      s = c.value;
  } catch (e) {
    return void n(e);
  }
  c.done ? t(s) : Promise.resolve(s).then(i, o);
}
function W(e) {
  return function () {
    var t = this,
      n = arguments;
    return new Promise(function (i, o) {
      var r = e.apply(t, n);
      function a(e) {
        G(r, i, o, a, c, "next", e);
      }
      function c(e) {
        G(r, i, o, a, c, "throw", e);
      }
      a(void 0);
    });
  };
}
function K() {
  return (K =
    Object.assign ||
    function (e) {
      for (var t = 1; t < arguments.length; t++) {
        var n = arguments[t];
        for (var i in n)
          Object.prototype.hasOwnProperty.call(n, i) && (e[i] = n[i]);
      }
      return e;
    }).apply(this, arguments);
}
function V(e, t) {
  if (null == e) return {};
  var n,
    i,
    o = {},
    r = Object.keys(e);
  for (i = 0; i < r.length; i++) t.indexOf((n = r[i])) >= 0 || (o[n] = e[n]);
  return o;
}
function H(e, t) {
  (null == t || t > e.length) && (t = e.length);
  for (var n = 0, i = new Array(t); n < t; n++) i[n] = e[n];
  return i;
}
function J(e, t) {
  var n =
    ("undefined" != typeof Symbol && e[Symbol.iterator]) || e["@@iterator"];
  if (n) return (n = n.call(e)).next.bind(n);
  if (
    Array.isArray(e) ||
    (n = (function (e, t) {
      if (e) {
        if ("string" == typeof e) return H(e, void 0);
        var n = Object.prototype.toString.call(e).slice(8, -1);
        return (
          "Object" === n && e.constructor && (n = e.constructor.name),
          "Map" === n || "Set" === n
            ? Array.from(e)
            : "Arguments" === n ||
              /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)
            ? H(e, void 0)
            : void 0
        );
      }
    })(e)) ||
    (t && e && "number" == typeof e.length)
  ) {
    n && (e = n);
    var i = 0;
    return function () {
      return i >= e.length ? { done: !0 } : { done: !1, value: e[i++] };
    };
  }
  throw new TypeError(
    "Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."
  );
}
var Q = {
    startX: 0,
    startY: 0,
    item: null,
    isDrag: !1,
    ref: null,
    current: 0,
    lastClick: null,
    itemX: 0,
    itemY: 0,
  },
  Z = {
    yhLeftrender: "index_yhLeftrender__r-HSc",
    leftco: "index_leftco__dCCWe",
    coitem: "index_coitem__6-dBJ",
    redbox: "index_redbox__T9xbI",
    "icon-checkbox": "index_icon-checkbox__-pvCD",
    "icon-tabs": "index_icon-tabs__mnhbN",
    "icon-jiantou": "index_icon-jiantou__bfGrv",
    yh_container: "index_yh_container__W34dN",
    yh_container_preview: "index_yh_container_preview__t6q3n",
    yh_block_focus: "index_yh_block_focus__4oPat",
    yhTempDiv: "index_yhTempDiv__MLoKM",
    resizepoint: "index_resizepoint__COZqK",
    l: "index_l__GR7nv",
    r: "index_r__p-75T",
    t: "index_t__jUGS0",
    b: "index_b__gAgsF",
    lt: "index_lt__iuqdj",
    lb: "index_lb__LWgSL",
    rb: "index_rb__hrQzS",
    rt: "index_rt__ltvIz",
    menuWidth: "index_menuWidth__CqEqC",
    menus: "index_menus__xP4bX",
    menuStyle: "index_menuStyle__ClQ2N",
    menu_footer: "index_menu_footer__rkrgT",
    rotate: "index_rotate__I5p1A",
    rotatereset: "index_rotatereset__fIeQC",
    yh_container_wrapper: "index_yh_container_wrapper__6e8jX",
    minwx: "index_minwx__QteEt",
  };
function $(e, t) {
  return { x: e.x - t.x, y: e.y - t.y };
}
function ee(e) {
  for (var t = e.length, n = [], i = 1, o = e[0]; i < t; i++) {
    var r = e[i];
    n.push($(r, o)), (o = r);
  }
  return n.push($(e[0], e[t - 1])), n;
}
function te(e) {
  return Math.sqrt(e.x * e.x + e.y * e.y);
}
function ne(e, t) {
  for (var n, i, o = null, r = null, a = 0, c = t.length; a < c; a++) {
    var s = ((n = t[a]).x * (i = e).x + n.y * i.y) / te(e);
    (null === o || s < o) && (o = s), (null === r || s > r) && (r = s);
  }
  return { min: o, max: r };
}
function ie(e) {
  var t = (function (e) {
      return { x: e.left + e.width / 2, y: e.top + e.height / 2 };
    })(e),
    n = t.x,
    i = t.y,
    o = [];
  return {
    rootPoint: [
      { x: e.left, y: e.top },
      { x: e.left + e.width, y: e.top },
      { x: e.left + e.width, y: e.top + e.height },
      { x: e.left, y: e.top + e.height },
    ].map(function (t) {
      var r = t.x,
        a = t.y,
        c =
          n + (r - n) * Math.cos(U(e.rotate)) - (a - i) * Math.sin(U(e.rotate)),
        s =
          i + (r - n) * Math.sin(U(e.rotate)) + (a - i) * Math.cos(U(e.rotate));
      return o.push({ x: n - c, y: i - s }), { x: c, y: s };
    }),
    relativePoint: o,
  };
}
var oe = { selectDiv: null, posx: 0, posy: 0, startX: 0, startY: 0 };
function re(e) {
  oe.selectDiv &&
    ((oe.selectDiv.style.left = Math.min(e.clientX, oe.posx) + "px"),
    (oe.selectDiv.style.top = Math.min(e.clientY, oe.posy) + "px"),
    (oe.selectDiv.style.width = Math.abs(oe.posx - e.clientX) + "px"),
    (oe.selectDiv.style.height = Math.abs(oe.posy - e.clientY) + "px"));
}
function ae(e, t) {
  if (oe.selectDiv) {
    var n = 0,
      i = 0,
      o = t.getScaleState(),
      r = oe.selectDiv.getBoundingClientRect(),
      a = o.value,
      c = r.width / a,
      s = r.height / a;
    !(function (e) {
      return !(e instanceof Event);
    })(e)
      ? ((n = oe.startX - c), (i = oe.startY - s))
      : ((n = Math.min(e.nativeEvent.offsetX, oe.startX)),
        (i = Math.min(e.nativeEvent.offsetY, oe.startY))),
      (function (e, t, n, i, o) {
        if (0 !== n && 0 !== i) {
          var r = o.getStore(),
            a = _(r.getData()),
            c = o.getFocusState(),
            s = !1;
          a.block.forEach(function (o) {
            var r = o.left,
              a = o.top,
              l = o.width,
              u = o.height;
            "number" == typeof r &&
              "number" == typeof a &&
              "number" == typeof l &&
              "number" == typeof u &&
              !0 === o.canDrag &&
              (function (e, t) {
                return (function (e, t) {
                  for (
                    var n,
                      i = ie(e),
                      o = ie(t),
                      r = ee(i.relativePoint),
                      a = ee(o.relativePoint),
                      c = r.concat(a),
                      s = 0,
                      l = c.length;
                    s < l;
                    s++
                  ) {
                    var u = { x: (n = c[s]).y, y: -n.x };
                    if (
                      ((f = ne(u, i.rootPoint)),
                      (d = ne(u, o.rootPoint)),
                      f.max - f.min + (d.max - d.min) <
                        (f.max > d.max ? f.max : d.max) -
                          (f.min < d.min ? f.min : d.min))
                    )
                      return !1;
                  }
                  var f, d;
                  return !0;
                })(e, t);
              })(
                {
                  left: r,
                  top: a,
                  width: l,
                  height: u,
                  rotate: o.rotate.value,
                },
                { left: e, width: n, height: i, top: t, rotate: 0 }
              ) &&
              ((s = !0), (o.focus = !0), c.blocks.push(o));
          }),
            s && r.setData(a);
        }
      })(n, i, c, s, t),
      oe.selectDiv.parentNode.removeChild(oe.selectDiv),
      (oe.selectDiv = null);
  }
}
var ce = function () {
    var e = t.useState(0)[1];
    return (
      (se.forceUpdate = function () {
        e(function (e) {
          return e + 1;
        });
      }),
      n.createElement(
        "div",
        {
          style: {
            left: se.left,
            top: se.top,
            position: "fixed",
            background: "rgb(24, 23, 23)",
          },
        },
        n.createElement(
          a,
          {
            onClick: function () {
              le();
            },
          },
          "请参考文档自定义右键菜单"
        )
      )
    );
  },
  se = {
    left: 0,
    top: 0,
    menu: null,
    parent: null,
    contextMenu: n.createElement(ce, null),
    unmountContextMenu: le,
    observer: null,
    initLeft: 0,
    initTop: 0,
    forceUpdate: function () {},
    state: !1,
  };
function le() {
  (se.state = !1),
    se.observer && se.observer.disconnect(),
    se.menu &&
      se.parent &&
      (c.unmountComponentAtNode(se.parent),
      se.menu.removeChild(se.parent),
      (se.parent = null));
}
function ue(e) {
  var t = e.getStore(),
    n = e.getFocusState(),
    i = _(t.getData()),
    o = i.block.map(function (e) {
      return (e.focus = !1), e;
    });
  (n.blocks = []), t.setData(K({}, i, { block: o })), le();
}
function fe(e) {
  return {
    onMouseDown: function (t) {
      ue(e),
        Q.item ||
          (function (e, t) {
            oe.selectDiv || (oe.selectDiv = document.createElement("div")),
              oe.selectDiv &&
                ((oe.startX = e.nativeEvent.offsetX),
                (oe.startY = e.nativeEvent.offsetY),
                (oe.posx = e.clientX),
                (oe.posy = e.clientY),
                (oe.selectDiv.className = Z.yhTempDiv),
                (oe.selectDiv.style.left = e.clientX + "px"),
                (oe.selectDiv.style.top = e.clientY + "px"),
                (oe.selectDiv.style.position = "fixed"),
                document.body.appendChild(oe.selectDiv),
                (oe.selectDiv.onmouseup = function (e) {
                  return ae(e, t);
                }),
                (oe.selectDiv.onmousemove = function (e) {
                  return re(e);
                }));
          })(t, e);
    },
  };
}
function de(e, t, n, i) {
  var o, r, a;
  return (
    (function (e) {
      ue(e);
    })(i),
    {
      id: A(n.name),
      name: n.name,
      top: e,
      left: t,
      zIndex: n.initData.zIndex || 0,
      props: n.initData.props || {},
      resize: n.initData.resize || n.resize,
      focus: null == (o = n.initData.focus) || o,
      position: n.initData.position || "absolute",
      display: n.initData.display || "block",
      width: n.initData.width,
      height: n.initData.height,
      syncList: n.initData.syncList || [],
      canDrag: null == (r = n.initData.canDrag) || r,
      canSee: null == (a = n.initData.canSee) || a,
      eventMap: n.initData.eventMap || {},
      functionList: n.initData.functionList || [],
      animate: n.initData.animate || [],
      fixed: n.initData.fixed || !1,
      rotate: n.initData.rotate || { value: 0, canRotate: !0 },
    }
  );
}
var me = null;
function ge(e, t, n, i, o, r) {
  void 0 === r && (r = !1);
  var a = e.getComponentRegister(),
    c = e.getStore(),
    s = a.getComp(t.component);
  if (s) {
    var l,
      u,
      f,
      d = n.target,
      m = i,
      g = o;
    s.initData.width &&
      "number" == typeof s.initData.width &&
      (m = i - s.initData.width / 2),
      s.initData.height &&
        "number" == typeof s.initData.height &&
        (g = o - s.initData.height / 2),
      (l = s.needPosition
        ? r
          ? de(g, m, s, e)
          : "yh-container" !== d.id
          ? de(g + d.offsetTop, m + d.offsetLeft, s, e)
          : de(g, m, s, e)
        : de(
            null != (u = s.initData.top) ? u : g,
            null != (f = s.initData.left) ? f : m,
            s,
            e
          ));
    var p = _(c.getData());
    p.block.push(l), c.setData(K({}, p));
  } else console.log(t.component, "wait the chunk pull compeletely and retry");
}
var pe = function (e, t) {
    return {
      draggable: !0,
      onDragStart: function () {
        me = e;
      },
      onDragOver: function (e) {
        e.preventDefault();
      },
      onDrop: function () {},
      onDragEnd: function () {},
      onDoubleClick: function (n) {
        var i = t.getStore().getData().container;
        ge(t, e, n, i.width / 2, i.height / 2, !0);
      },
    };
  },
  he = function (e) {
    return {
      onDragStart: function () {},
      onDragOver: function (e) {
        e.preventDefault();
      },
      onDrop: function (t) {
        var n = Math.round(t.nativeEvent.offsetX),
          i = Math.round(t.nativeEvent.offsetY);
        me && ge(e, me, t, n, i), (me = null);
      },
      onDragEnd: function () {},
    };
  },
  ve = {
    indent: 5,
    isAbsorb: !0,
    mode: "normal",
    gridIndent: 50,
    resizeIndent: 0,
    marklineUnfocus: null,
    borderColor: "rgba( 33 , 150 , 243, 1 )",
    borderStyle: "dotted",
  },
  ye = ["lt", "t", "rt", "r", "rb", "b", "lb", "l"],
  xe = {
    startX: 0,
    startY: 0,
    item: null,
    isResize: !1,
    direction: "b",
    ref: null,
    current: 0,
    currentTarget: null,
    symmetricPoint: { x: 0, y: 0 },
    curPosition: { x: 0, y: 0 },
  };
function be(e, t) {
  return { x: e.x + (t.x - e.x) / 2, y: e.y + (t.y - e.y) / 2 };
}
function we(e, t, n) {
  return {
    x: (e.x - t.x) * Math.cos(U(n)) - (e.y - t.y) * Math.sin(U(n)) + t.x,
    y: (e.x - t.x) * Math.sin(U(n)) + (e.y - t.y) * Math.cos(U(n)) + t.y,
  };
}
var Me = { lt: 0, t: 45, rt: 90, r: 135, rb: 180, b: 225, lb: 270, l: 315 },
  Ee = [
    { start: 338, end: 23, cursor: "nw" },
    { start: 23, end: 68, cursor: "n" },
    { start: 68, end: 113, cursor: "ne" },
    { start: 113, end: 158, cursor: "e" },
    { start: 158, end: 203, cursor: "se" },
    { start: 203, end: 248, cursor: "s" },
    { start: 248, end: 293, cursor: "sw" },
    { start: 293, end: 338, cursor: "w" },
  ];
function Ce(e) {
  return (e + 360) % 360;
}
var Se = function (e) {
  (xe.isResize = !1), (xe.item = null);
  var t = e.getStore();
  if (xe.current) {
    var n = t.getIndex();
    t.getStoreList().splice(xe.current, n - xe.current), t.setIndex(xe.current);
  }
  xe.current = 0;
};
function ke(e) {
  var i,
    o,
    r,
    a =
      ((i = Ce(e.data.rotate.value)),
      (o = {}),
      (r = -1),
      ye.forEach(function (e) {
        for (var t = Ce(Me[e] + i), n = Ee.length; ; ) {
          var a = Ee[(r = (r + 1) % n)];
          if (t < 23 || t >= 338) return void (o[e] = "nw-resize");
          if (a.start <= t && t < a.end)
            return void (o[e] = a.cursor + "-resize");
        }
      }),
      o),
    c = t.useMemo(
      function () {
        return e.data.focus && e.data.resize && e.data.canDrag
          ? n.createElement(
              n.Fragment,
              null,
              ye.map(function (t) {
                return n.createElement("div", {
                  style: { cursor: a[t] },
                  key: t,
                  className: l(Z.resizepoint, Z[t]),
                  onMouseDown: function (n) {
                    !(function (e, t, n, i, o) {
                      e.stopPropagation();
                      var r = o.getStore();
                      (xe.isResize = !0),
                        (xe.item = n),
                        (xe.startX = e.clientX),
                        (xe.startY = e.clientY),
                        (xe.direction = t),
                        (xe.ref = i),
                        (xe.current = r.getIndex()),
                        (xe.currentTarget = e.nativeEvent.target);
                      var a = xe.ref.current,
                        c = z();
                      if (c && a && i.current) {
                        var s = c.getBoundingClientRect(),
                          l = o.getScaleState().value,
                          u = a.offsetLeft + a.offsetWidth / 2,
                          f = a.offsetTop + a.offsetHeight / 2,
                          d = {
                            x:
                              (xe.currentTarget.getBoundingClientRect().left -
                                s.left) /
                              l,
                            y:
                              (xe.currentTarget.getBoundingClientRect().top -
                                s.top) /
                              l,
                          };
                        (xe.symmetricPoint = {
                          x: u - (d.x - u),
                          y: f - (d.y - f),
                        }),
                          (xe.curPosition = d);
                      }
                    })(n, t, e.data, e.rect, e.config);
                  },
                  onMouseUp: function () {
                    Se(e.config);
                  },
                });
              })
            )
          : null;
      },
      [a, e.config, e.data, e.rect]
    );
  return n.createElement(n.Fragment, null, c);
}
var De = { startX: 0, startY: 0, fn: function () {}, isMove: !1 },
  Ne = function () {
    De.isMove && (De.isMove = !1);
  },
  Ie = { isDrag: !1, startY: 0, startIndex: 0, minHeight: 0 },
  Le = function (e, t) {
    var n = t.getStore();
    (Ie.isDrag = !0), (Ie.startY = e.clientY), (Ie.startIndex = n.getIndex());
  },
  Fe = function (e, t) {
    if (Ie.isDrag) {
      var n = t.getScaleState(),
        i = t.getStore(),
        o = ((e.clientY - Ie.startY) / n.value) * 2,
        r = _(i.getData()),
        a = r.container.height,
        c = Math.round(a + o < Ie.minHeight ? Ie.minHeight : a + o);
      (r.container.height = c), i.setData(r), (Ie.startY = e.clientY);
    }
    !(function (e) {
      if (De.isMove) {
        var t = e.clientX - De.startX,
          n = e.clientY - De.startY,
          i = De.fn;
        i &&
          i(function (e) {
            return { x: e.x + t, y: e.y + n };
          }),
          (De.startX = e.clientX),
          (De.startY = e.clientY);
      }
    })(e);
  },
  Re = function (e) {
    if (Ie.isDrag) {
      var t = e.getStore();
      Ie.isDrag = !1;
      var n = t.getIndex();
      t.getStoreList().splice(Ie.startIndex, n - Ie.startIndex),
        t.setIndex(Ie.startIndex);
    }
  },
  _e = { isDrag: !1, startX: 0, startY: 0, needX: 0, needY: 0, ref: null },
  Oe = { isDrag: !1, startX: 0, startY: 0, needX: 0, needY: 0 },
  Ae = { ref: null },
  Xe = {
    startX: 0,
    startY: 0,
    item: null,
    isRotate: !1,
    ref: null,
    current: 0,
  };
function Te(e) {
  var i = t.useMemo(
    function () {
      return e.data.focus && e.data.rotate.canRotate && e.data.canDrag
        ? n.createElement(
            "div",
            {
              onMouseDown: function (t) {
                !(function (e, t, n, i) {
                  e.stopPropagation();
                  var o = i.getStore();
                  (Xe.isRotate = !0),
                    (Xe.item = t),
                    (Xe.startX = e.clientX),
                    (Xe.startY = e.clientY),
                    (Xe.ref = n),
                    (Xe.current = o.getIndex());
                })(t, e.data, e.rect, e.config);
              },
              className: Z.rotate,
              title: "rotate",
            },
            n.createElement(u.ReloadOutlined, { style: { color: "#2196f3" } })
          )
        : null;
    },
    [e.config, e.data, e.rect]
  );
  return n.createElement(n.Fragment, null, i);
}
function je(e) {
  var i = t.useMemo(
    function () {
      return e.data.focus && e.data.rotate.canRotate && e.data.canDrag
        ? n.createElement(
            "div",
            {
              onMouseDown: function (t) {
                !(function (e, t, n) {
                  e.stopPropagation();
                  var i = n.getStore(),
                    o = _(i.getData());
                  o.block.forEach(function (e) {
                    e.id === t.id && (e.rotate.value = 0);
                  }),
                    i.setData(o);
                })(t, e.data, e.config);
              },
              className: Z.rotatereset,
              title: "rotate reset",
            },
            n.createElement(u.RotateLeftOutlined, null)
          )
        : null;
    },
    [e.config, e.data]
  );
  return n.createElement(n.Fragment, null, i);
}
var Ye = {
    cache: null,
    sortLeft: null,
    sortTop: null,
    sortRight: null,
    sortBottom: null,
  },
  Pe = { startX: 0, isMove: !1, uid: "" },
  Ue = "",
  ze = { startX: 0, isMove: !1, uid: "", left: !0 },
  qe = function (e, t, n) {
    e.stopPropagation(),
      (ze.startX = e.clientX),
      (ze.uid = t.uid),
      (ze.isMove = !0),
      (ze.left = n);
  },
  Be = function () {
    (Pe.isMove = !1),
      (Pe.startX = 0),
      (Pe.uid = ""),
      (ze.isMove = !1),
      (ze.startX = 0),
      (ze.uid = "");
  },
  Ge = {
    transform: "rotate(45deg)",
    height: 5,
    width: 5,
    position: "absolute",
    background: "rgba(0, 0, 0, 0.85)",
    top: 7,
    cursor: "e-resize",
  },
  We = {};
function Ke(e) {
  return n.createElement(
    n.Fragment,
    null,
    e.animate.map(function (e) {
      var t = 20 * e.animationDelay + 19,
        i =
          "infinite" === e.animationIterationCount
            ? 500
            : parseInt(e.animationIterationCount),
        o = 20 * e.animationDuration * i;
      return (
        We[e.uid] ||
          (We[e.uid] =
            "#" +
            ("00000" + ((16777216 * Math.random()) << 0).toString(16)).slice(
              -6
            )),
        n.createElement(
          "div",
          {
            key: e.uid,
            onMouseDown: function (t) {
              (Pe.startX = t.clientX),
                (Pe.uid = e.uid),
                (Pe.isMove = !0),
                (Ue = e.uid);
            },
            className: "yh-timeline-item-mainblock",
            style: {
              position: "absolute",
              top: 3,
              left: t,
              width: o,
              height: 19,
              background: We[e.uid],
              zIndex: 1,
              cursor: "move",
              borderRadius: "4px",
              opacity: e.uid === Ue ? 1 : 0.7,
            },
          },
          e.uid === Ue &&
            n.createElement(
              n.Fragment,
              null,
              n.createElement("div", {
                className: "yh-timeline-item-left",
                style: K({}, Ge, { left: -2.5 }),
                onMouseDown: function (t) {
                  qe(t, e, !0);
                },
              }),
              n.createElement("div", {
                className: "yh-timeline-item-right",
                style: K({}, Ge, { right: -2.5 }),
                onMouseDown: function (t) {
                  qe(t, e, !1);
                },
              })
            )
        )
      );
    })
  );
}
var Ve,
  He =
    ((function (e) {
      var t = (function (e) {
        var t = Object.prototype,
          n = t.hasOwnProperty,
          i = "function" == typeof Symbol ? Symbol : {},
          o = i.iterator || "@@iterator",
          r = i.asyncIterator || "@@asyncIterator",
          a = i.toStringTag || "@@toStringTag";
        function c(e, t, n) {
          return (
            Object.defineProperty(e, t, {
              value: n,
              enumerable: !0,
              configurable: !0,
              writable: !0,
            }),
            e[t]
          );
        }
        try {
          c({}, "");
        } catch (e) {
          c = function (e, t, n) {
            return (e[t] = n);
          };
        }
        function s(e, t, n, i) {
          var o = Object.create(
              (t && t.prototype instanceof f ? t : f).prototype
            ),
            r = new E(i || []);
          return (
            (o._invoke = (function (e, t, n) {
              var i = "suspendedStart";
              return function (o, r) {
                if ("executing" === i)
                  throw new Error("Generator is already running");
                if ("completed" === i) {
                  if ("throw" === o) throw r;
                  return { value: void 0, done: !0 };
                }
                for (n.method = o, n.arg = r; ; ) {
                  var a = n.delegate;
                  if (a) {
                    var c = b(a, n);
                    if (c) {
                      if (c === u) continue;
                      return c;
                    }
                  }
                  if ("next" === n.method) n.sent = n._sent = n.arg;
                  else if ("throw" === n.method) {
                    if ("suspendedStart" === i)
                      throw ((i = "completed"), n.arg);
                    n.dispatchException(n.arg);
                  } else "return" === n.method && n.abrupt("return", n.arg);
                  i = "executing";
                  var s = l(e, t, n);
                  if ("normal" === s.type) {
                    if (
                      ((i = n.done ? "completed" : "suspendedYield"),
                      s.arg === u)
                    )
                      continue;
                    return { value: s.arg, done: n.done };
                  }
                  "throw" === s.type &&
                    ((i = "completed"), (n.method = "throw"), (n.arg = s.arg));
                }
              };
            })(e, n, r)),
            o
          );
        }
        function l(e, t, n) {
          try {
            return { type: "normal", arg: e.call(t, n) };
          } catch (e) {
            return { type: "throw", arg: e };
          }
        }
        e.wrap = s;
        var u = {};
        function f() {}
        function d() {}
        function m() {}
        var g = {};
        c(g, o, function () {
          return this;
        });
        var p = Object.getPrototypeOf,
          h = p && p(p(C([])));
        h && h !== t && n.call(h, o) && (g = h);
        var v = (m.prototype = f.prototype = Object.create(g));
        function y(e) {
          ["next", "throw", "return"].forEach(function (t) {
            c(e, t, function (e) {
              return this._invoke(t, e);
            });
          });
        }
        function x(e, t) {
          var i;
          this._invoke = function (o, r) {
            function a() {
              return new t(function (i, a) {
                !(function i(o, r, a, c) {
                  var s = l(e[o], e, r);
                  if ("throw" !== s.type) {
                    var u = s.arg,
                      f = u.value;
                    return f && "object" == typeof f && n.call(f, "__await")
                      ? t.resolve(f.__await).then(
                          function (e) {
                            i("next", e, a, c);
                          },
                          function (e) {
                            i("throw", e, a, c);
                          }
                        )
                      : t.resolve(f).then(
                          function (e) {
                            (u.value = e), a(u);
                          },
                          function (e) {
                            return i("throw", e, a, c);
                          }
                        );
                  }
                  c(s.arg);
                })(o, r, i, a);
              });
            }
            return (i = i ? i.then(a, a) : a());
          };
        }
        function b(e, t) {
          var n = e.iterator[t.method];
          if (void 0 === n) {
            if (((t.delegate = null), "throw" === t.method)) {
              if (
                e.iterator.return &&
                ((t.method = "return"),
                (t.arg = void 0),
                b(e, t),
                "throw" === t.method)
              )
                return u;
              (t.method = "throw"),
                (t.arg = new TypeError(
                  "The iterator does not provide a 'throw' method"
                ));
            }
            return u;
          }
          var i = l(n, e.iterator, t.arg);
          if ("throw" === i.type)
            return (
              (t.method = "throw"), (t.arg = i.arg), (t.delegate = null), u
            );
          var o = i.arg;
          return o
            ? o.done
              ? ((t[e.resultName] = o.value),
                (t.next = e.nextLoc),
                "return" !== t.method &&
                  ((t.method = "next"), (t.arg = void 0)),
                (t.delegate = null),
                u)
              : o
            : ((t.method = "throw"),
              (t.arg = new TypeError("iterator result is not an object")),
              (t.delegate = null),
              u);
        }
        function w(e) {
          var t = { tryLoc: e[0] };
          1 in e && (t.catchLoc = e[1]),
            2 in e && ((t.finallyLoc = e[2]), (t.afterLoc = e[3])),
            this.tryEntries.push(t);
        }
        function M(e) {
          var t = e.completion || {};
          (t.type = "normal"), delete t.arg, (e.completion = t);
        }
        function E(e) {
          (this.tryEntries = [{ tryLoc: "root" }]),
            e.forEach(w, this),
            this.reset(!0);
        }
        function C(e) {
          if (e) {
            var t = e[o];
            if (t) return t.call(e);
            if ("function" == typeof e.next) return e;
            if (!isNaN(e.length)) {
              var i = -1,
                r = function t() {
                  for (; ++i < e.length; )
                    if (n.call(e, i)) return (t.value = e[i]), (t.done = !1), t;
                  return (t.value = void 0), (t.done = !0), t;
                };
              return (r.next = r);
            }
          }
          return { next: S };
        }
        function S() {
          return { value: void 0, done: !0 };
        }
        return (
          (d.prototype = m),
          c(v, "constructor", m),
          c(m, "constructor", d),
          (d.displayName = c(m, a, "GeneratorFunction")),
          (e.isGeneratorFunction = function (e) {
            var t = "function" == typeof e && e.constructor;
            return (
              !!t &&
              (t === d || "GeneratorFunction" === (t.displayName || t.name))
            );
          }),
          (e.mark = function (e) {
            return (
              Object.setPrototypeOf
                ? Object.setPrototypeOf(e, m)
                : ((e.__proto__ = m), c(e, a, "GeneratorFunction")),
              (e.prototype = Object.create(v)),
              e
            );
          }),
          (e.awrap = function (e) {
            return { __await: e };
          }),
          y(x.prototype),
          c(x.prototype, r, function () {
            return this;
          }),
          (e.AsyncIterator = x),
          (e.async = function (t, n, i, o, r) {
            void 0 === r && (r = Promise);
            var a = new x(s(t, n, i, o), r);
            return e.isGeneratorFunction(n)
              ? a
              : a.next().then(function (e) {
                  return e.done ? e.value : a.next();
                });
          }),
          y(v),
          c(v, a, "Generator"),
          c(v, o, function () {
            return this;
          }),
          c(v, "toString", function () {
            return "[object Generator]";
          }),
          (e.keys = function (e) {
            var t = [];
            for (var n in e) t.push(n);
            return (
              t.reverse(),
              function n() {
                for (; t.length; ) {
                  var i = t.pop();
                  if (i in e) return (n.value = i), (n.done = !1), n;
                }
                return (n.done = !0), n;
              }
            );
          }),
          (e.values = C),
          (E.prototype = {
            constructor: E,
            reset: function (e) {
              if (
                ((this.prev = 0),
                (this.next = 0),
                (this.sent = this._sent = void 0),
                (this.done = !1),
                (this.delegate = null),
                (this.method = "next"),
                (this.arg = void 0),
                this.tryEntries.forEach(M),
                !e)
              )
                for (var t in this)
                  "t" === t.charAt(0) &&
                    n.call(this, t) &&
                    !isNaN(+t.slice(1)) &&
                    (this[t] = void 0);
            },
            stop: function () {
              this.done = !0;
              var e = this.tryEntries[0].completion;
              if ("throw" === e.type) throw e.arg;
              return this.rval;
            },
            dispatchException: function (e) {
              if (this.done) throw e;
              var t = this;
              function i(n, i) {
                return (
                  (a.type = "throw"),
                  (a.arg = e),
                  (t.next = n),
                  i && ((t.method = "next"), (t.arg = void 0)),
                  !!i
                );
              }
              for (var o = this.tryEntries.length - 1; o >= 0; --o) {
                var r = this.tryEntries[o],
                  a = r.completion;
                if ("root" === r.tryLoc) return i("end");
                if (r.tryLoc <= this.prev) {
                  var c = n.call(r, "catchLoc"),
                    s = n.call(r, "finallyLoc");
                  if (c && s) {
                    if (this.prev < r.catchLoc) return i(r.catchLoc, !0);
                    if (this.prev < r.finallyLoc) return i(r.finallyLoc);
                  } else if (c) {
                    if (this.prev < r.catchLoc) return i(r.catchLoc, !0);
                  } else {
                    if (!s)
                      throw new Error("try statement without catch or finally");
                    if (this.prev < r.finallyLoc) return i(r.finallyLoc);
                  }
                }
              }
            },
            abrupt: function (e, t) {
              for (var i = this.tryEntries.length - 1; i >= 0; --i) {
                var o = this.tryEntries[i];
                if (
                  o.tryLoc <= this.prev &&
                  n.call(o, "finallyLoc") &&
                  this.prev < o.finallyLoc
                ) {
                  var r = o;
                  break;
                }
              }
              r &&
                ("break" === e || "continue" === e) &&
                r.tryLoc <= t &&
                t <= r.finallyLoc &&
                (r = null);
              var a = r ? r.completion : {};
              return (
                (a.type = e),
                (a.arg = t),
                r
                  ? ((this.method = "next"), (this.next = r.finallyLoc), u)
                  : this.complete(a)
              );
            },
            complete: function (e, t) {
              if ("throw" === e.type) throw e.arg;
              return (
                "break" === e.type || "continue" === e.type
                  ? (this.next = e.arg)
                  : "return" === e.type
                  ? ((this.rval = this.arg = e.arg),
                    (this.method = "return"),
                    (this.next = "end"))
                  : "normal" === e.type && t && (this.next = t),
                u
              );
            },
            finish: function (e) {
              for (var t = this.tryEntries.length - 1; t >= 0; --t) {
                var n = this.tryEntries[t];
                if (n.finallyLoc === e)
                  return this.complete(n.completion, n.afterLoc), M(n), u;
              }
            },
            catch: function (e) {
              for (var t = this.tryEntries.length - 1; t >= 0; --t) {
                var n = this.tryEntries[t];
                if (n.tryLoc === e) {
                  var i = n.completion;
                  if ("throw" === i.type) {
                    var o = i.arg;
                    M(n);
                  }
                  return o;
                }
              }
              throw new Error("illegal catch attempt");
            },
            delegateYield: function (e, t, n) {
              return (
                (this.delegate = { iterator: C(e), resultName: t, nextLoc: n }),
                "next" === this.method && (this.arg = void 0),
                u
              );
            },
          }),
          e
        );
      })(e.exports);
      try {
        regeneratorRuntime = t;
      } catch (e) {
        "object" == typeof globalThis
          ? (globalThis.regeneratorRuntime = t)
          : Function("r", "regeneratorRuntime = r")(t);
      }
    })((Ve = { exports: {} })),
    Ve.exports),
  Je = {
    "timeline.name": "Component name",
    "contorl.popup.absolute":
      "Are you sure to change to absolutely positioned element",
    "contorl.popup.static":
      "Are you sure to change to static positioned element",
    "contorl.absolute": "Change to absolute",
    "contorl.static": "Change to static",
    "control.popup.delete": "Are you sure to delete",
    "control.delete": "Delete",
    "control.focus": "Focus",
    "control.no-component": "No components",
    "modal.new": "New modal",
    "modal.control": "Control modal",
    "modal.popup.exit":
      "Please exit the edit modal and open the configuration again",
    "modal.popup.edit": "Switch to this modal and edit it?",
    "modal.popup.save": "Please save the modal and edit another modal",
    "modal.popup.notfond": "Can not found {name} modal",
    "modal.popup.repeat": "Duplicate name {name} already exists",
    "modal.popup.remove": "Please save the modal before deleting",
    "modal.popup.nomodal": "No modal",
    "modal.popup.name": "Please enter modal name",
    "modal.name": "Modal name",
    "modal.control.remove": "Delete click to delete the effect of the modal",
    edit: "Edit",
    yes: "Ok",
    no: "Cancel",
    "right.noprops": "No properties have been configured",
    "right.global": "Global config",
    "right.containerheight": "Container height",
    "right.containerwidth": "Container width",
    "right.containerColor": "Container background color",
    "right.bodyColor": "Body background color",
    "right.fontSize": "Container font size",
    "right.lineHeight": "Container line height",
    title: "Title",
    description: "Description",
    "system.setting": "System Settings",
    "settings.openabsorb": "Turn on adsorption",
    on: "on",
    off: "off",
    "settings.absorbindent": "Adsorption spacing",
    "settings.min": "Canvas zoom min",
    "settings.max": "Canvas zoom max",
    "settings.autofocus": "Auto scroll focus on the animation panel",
    "error.minmax":
      "The maximum value should be greater than or equal to the minimum value",
    "settings.marklineColor": "Markline color",
    "settings.marklineStyle": "Markline style",
    "settings.containerOverflow": "Container Overflow",
    "settings.Layout": "Layout config",
  },
  Qe = {
    "timeline.name": "组件名称",
    "contorl.popup.absolute": "确认变更为绝对定位吗",
    "contorl.popup.static": "确认变更为静态定位吗",
    "contorl.absolute": "切换绝对定位",
    "contorl.static": "切换静态定位",
    "control.popup.delete": "确认删除吗",
    "control.delete": "删除",
    "control.focus": "选中聚焦",
    "control.no-component": "暂无组件",
    "modal.new": "新增弹窗",
    "modal.control": "弹窗配置",
    "modal.popup.exit": "请退出编辑弹窗后再打开该配置",
    "modal.popup.edit": "是否切换至该弹窗并进行编辑?",
    "modal.popup.save": "请保存弹窗后编辑其他弹窗",
    "modal.popup.notfond": "未找到该弹窗 {name}",
    "modal.popup.repeat": "已有重名弹窗 {name}",
    "modal.popup.remove": "请保存弹窗后再删除",
    "modal.popup.nomodal": "暂时没有弹窗",
    "modal.popup.name": "请输入弹窗名称",
    "modal.name": "弹窗名称",
    "modal.control.remove": "取消点击删除弹窗",
    edit: "编辑",
    yes: "确定",
    no: "取消",
    "right.noprops": "还没有配置属性",
    "right.global": "全局设置",
    "right.containerheight": "容器高度",
    "right.containerwidth": "容器宽度",
    "right.containerColor": "容器底色",
    "right.bodyColor": "body底色",
    "right.fontSize": "容器字号",
    "right.lineHeight": "容器行高",
    title: "标题",
    description: "描述",
    "system.setting": "系统设置",
    "settings.openabsorb": "开启吸附",
    on: "开",
    off: "关",
    "settings.absorbindent": "吸附间距",
    "settings.min": "画布缩放最小值",
    "settings.max": "画布缩放最大值",
    "settings.autofocus": "动画面板点击自动滚动聚焦",
    "error.minmax": "最大值应大于等于最小值",
    "settings.marklineColor": "辅助线颜色",
    "settings.marklineStyle": "辅助线样式",
    "settings.containerOverflow": "容器边界外不显示元素",
    "settings.Layout": "外观设置",
  },
  Ze = function (e, t, i, o, r) {
    return i.i18n
      ? n.createElement(
          m.FormattedMessage,
          r
            ? { id: e, defaultMessage: r, values: o }
            : { id: e, defaultMessage: t }
        )
      : t;
  },
  $e = {
    __proto__: null,
    localeMap: { "zh-CN": Qe, en: Je },
    replaceLocale: Ze,
    en: Je,
    zhCN: Qe,
  },
  et = new Array(500).fill(1).map(function (e, t) {
    return t;
  }),
  tt = d.SortableHandle(function () {
    return n.createElement(u.MenuOutlined, null);
  }),
  nt = !1,
  it = "1px solid rgb(204, 204, 204)",
  ot = d.SortableElement(function (e) {
    var t = e.value;
    return n.createElement(
      "div",
      {
        style: {
          userSelect: "none",
          display: "flex",
          alignItems: "center",
          width: "100%",
          zIndex: 101,
        },
      },
      n.createElement(
        "div",
        {
          className: "yh-timeline-item",
          onClick: function () {
            var e = t.config.getStore(),
              n = r(e.getData());
            n.block.forEach(function (e) {
              e.focus = e.id === t.value.id && !F.includes(t.value.name);
            }),
              e.setData(n);
          },
          style: {
            display: "flex",
            alignItems: "center",
            width: 200,
            overflow: "auto",
            minWidth: 200,
            borderRight: it,
            borderBottom: it,
            backgroundColor: t.value.focus ? "#76767680" : "initial",
            cursor: "pointer",
          },
        },
        n.createElement(
          "div",
          { style: { width: 30, cursor: "move" } },
          n.createElement(tt, null)
        ),
        n.createElement(
          "div",
          null,
          t.config.getComponentRegister().getMap()[t.value.name].display
        ),
        n.createElement("div", null, t.value.id.slice(-6)),
        n.createElement(
          "div",
          {
            style: {
              marginLeft: 5,
              flex: 1,
              textAlign: "right",
              paddingRight: 5,
            },
          },
          n.createElement(
            "span",
            {
              style: { marginRight: 5 },
              onClick: function () {
                var e = t.config.getStore(),
                  n = r(e.getData());
                (n.block = n.block.map(function (e) {
                  return (
                    e.id !== t.value.id ||
                      F.includes(t.value.name) ||
                      (e.canSee = !e.canSee),
                    e
                  );
                })),
                  e.setData(n);
              },
            },
            n.createElement(
              t.value.canSee ? u.EyeOutlined : u.EyeInvisibleOutlined,
              null
            )
          ),
          n.createElement(
            f,
            {
              title: Ze("control.popup.delete", "确认删除么", t.config),
              onConfirm: function () {
                var e = t.config.getStore(),
                  n = r(e.getData());
                (n.block = n.block.filter(function (e) {
                  return !(e.id === t.value.id && !F.includes(t.value.name));
                })),
                  e.setData(n);
              },
              okText: Ze("yes", "确定", t.config),
              cancelText: Ze("no", "取消", t.config),
            },
            n.createElement(u.DeleteOutlined, null)
          )
        )
      )
    );
  }),
  rt = d.SortableContainer(function (e) {
    var t = e.items;
    return n.createElement(
      "div",
      null,
      t.data.map(function (e, i) {
        return n.createElement(ot, {
          key: e.id,
          index: i,
          value: { value: e, config: t.config },
        });
      })
    );
  }),
  at = [],
  ct = null,
  st = { isDrag: !1, startX: 0, origin: 0 },
  lt = function (e) {
    var t,
      n = e.timelineNeedleConfig.setNeedle;
    return {
      onMouseMove:
        ((t = W(
          He.mark(function t(i) {
            var o;
            return He.wrap(function (t) {
              for (;;)
                switch ((t.prev = t.next)) {
                  case 0:
                    st.isDrag &&
                      (i.persist(),
                      (o = i.clientX - st.startX),
                      n(function () {
                        var t = st.origin + o;
                        return t < 19
                          ? ((e.timelineNeedleConfig.current = 0), 19)
                          : t > 9960
                          ? ((e.timelineNeedleConfig.current = 497.05), 9960)
                          : ((e.timelineNeedleConfig.current = (t - 19) / 20),
                            t);
                      }),
                      (e.timelineNeedleConfig.status = "stop"),
                      e.blockForceUpdate.forEach(function (e) {
                        e();
                      }));
                  case 1:
                  case "end":
                    return t.stop();
                }
            }, t);
          })
        )),
        function (e) {
          return t.apply(this, arguments);
        }),
      onMouseUp: function () {
        (st.isDrag = !1), (st.startX = 0);
      },
    };
  };
function ut(e) {
  var i = e.config.getStore(),
    o = i.getData().block,
    a = t.useState(0)[1],
    c = t.useState(0),
    s = c[0],
    l = c[1],
    f = t.useState(0),
    d = f[0],
    m = f[1],
    g = n.createElement(
      "div",
      { style: { width: "100%", height: "100%", overflow: "hidden" } },
      n.createElement(
        "div",
        { style: { transform: "translate(0, -" + s + "px)" } },
        n.createElement(rt, {
          distance: 2,
          useDragHandle: !0,
          items: { data: o, config: e.config },
          onSortEnd: function (t) {
            var n = T(o, t.oldIndex, t.newIndex);
            if (!e.config.getStore().isEdit() || "modalMask" === n[0].name) {
              var i = e.config.getStore(),
                a = r(i.getData());
              (a.block = n), i.setData(a);
            }
          },
          axis: "y",
        })
      )
    ),
    p = t.useMemo(
      function () {
        return e.config.waitAnimate ? at : (at = o);
      },
      [o, e.config.waitAnimate]
    ),
    h = t.useRef(null);
  t.useEffect(
    function () {
      h.current && (e.config.timelineConfig.scrollDom = h.current);
    },
    [e.config]
  );
  var v,
    y,
    x = t.useState(19),
    b = x[0],
    w = x[1],
    M = (function () {
      var t = W(
        He.mark(function t() {
          return He.wrap(function (t) {
            for (;;)
              switch ((t.prev = t.next)) {
                case 0:
                  return t.abrupt(
                    "return",
                    new Promise(function (t) {
                      if (!nt) {
                        (nt = !0), (e.config.waitAnimate = !0);
                        var n = o.map(function (e) {
                            return e.animate;
                          }),
                          a = r(i.getData());
                        a.block.forEach(function (e) {
                          e.animate = [];
                        }),
                          i.setData(a),
                          setTimeout(function () {
                            e.config.timelineNeedleConfig.status = "pause";
                            var o = r(i.getData());
                            o.block.forEach(function (e, t) {
                              e.animate = n[t];
                            }),
                              (nt = !1),
                              (e.config.waitAnimate = !1),
                              i.setData(o),
                              i.cleanLast(),
                              t();
                          });
                      }
                    })
                  );
                case 1:
                case "end":
                  return t.stop();
              }
          }, t);
        })
      );
      return function () {
        return t.apply(this, arguments);
      };
    })(),
    E = function () {
      var e = r(i.getData());
      i.setData(e), i.cleanLast();
    },
    C = (function () {
      var t = W(
        He.mark(function t() {
          return He.wrap(function (t) {
            for (;;)
              switch ((t.prev = t.next)) {
                case 0:
                  if (
                    (ct && window.clearInterval(ct),
                    "pause" === e.config.timelineNeedleConfig.status)
                  ) {
                    t.next = 4;
                    break;
                  }
                  return (t.next = 4), S();
                case 4:
                  (e.config.timelineNeedleConfig.status = "start"),
                    (e.config.timelineNeedleConfig.isRefresh = !1),
                    E(),
                    setTimeout(function () {
                      ct = window.setInterval(function () {
                        w(function (t) {
                          return t < 9960
                            ? ((e.config.timelineNeedleConfig.current =
                                (t - 19) / 20),
                              t + 2)
                            : (ct && window.clearInterval(ct), t);
                        });
                      }, 100);
                    });
                case 8:
                case "end":
                  return t.stop();
              }
          }, t);
        })
      );
      return function () {
        return t.apply(this, arguments);
      };
    })(),
    S = (function () {
      var t = W(
        He.mark(function t(n) {
          return He.wrap(function (t) {
            for (;;)
              switch ((t.prev = t.next)) {
                case 0:
                  if (
                    (void 0 === n && (n = !0),
                    ct && window.clearInterval(ct),
                    (e.config.timelineNeedleConfig.status = "start"),
                    !n)
                  ) {
                    t.next = 6;
                    break;
                  }
                  return (t.next = 6), M();
                case 6:
                  return t.abrupt(
                    "return",
                    new Promise(function (t) {
                      setTimeout(function () {
                        (e.config.timelineNeedleConfig.status = "pause"),
                          (e.config.timelineNeedleConfig.current = 0),
                          (e.config.timelineNeedleConfig.isRefresh = !0),
                          w(19),
                          E(),
                          t();
                      });
                    })
                  );
                case 7:
                case "end":
                  return t.stop();
              }
          }, t);
        })
      );
      return function (e) {
        return t.apply(this, arguments);
      };
    })(),
    k = function () {
      (e.config.timelineNeedleConfig.status = "pause"),
        (e.config.timelineNeedleConfig.isRefresh = !1),
        ct && window.clearInterval(ct),
        E();
    };
  return (
    (e.config.timelineNeedleConfig.resetFunc = S),
    (e.config.timelineNeedleConfig.runFunc = C),
    (e.config.timelineNeedleConfig.pauseFunc = k),
    (e.config.timelineNeedleConfig.setNeedle = w),
    n.createElement(
      "div",
      {
        className: e.classes + " ant-menu yh-timeline-wrap",
        style: K(
          {
            width: "100%",
            position: "absolute",
            height: "150px",
            bottom: "0",
            zIndex: 100,
            display: "flex",
            flexDirection: "column",
          },
          e.style
        ),
        onMouseDown: function (e) {
          var t = e.target;
          (t.className &&
            t.className.indexOf &&
            t.className.indexOf("yh-timeline-item-mainblock") > -1) ||
            (Ue = "");
        },
      },
      n.createElement(
        n.Fragment,
        null,
        n.createElement(
          "div",
          {
            style: {
              display: "flex",
              lineHeight: "24px",
              paddingLeft: 10,
              height: "100%",
            },
          },
          n.createElement(
            "div",
            null,
            n.createElement(
              "div",
              {
                style: {
                  width: 200,
                  borderRight: "1px solid #dadada",
                  minWidth: 200,
                  borderBottom: "1px solid #dadada",
                  height: 25,
                  display: "flex",
                },
              },
              Ze("timeline.name", "组件名称", e.config),
              n.createElement(
                "div",
                { style: { flex: 1, textAlign: "right" } },
                n.createElement(
                  "span",
                  {
                    style: {
                      display: "inline-block",
                      cursor: "pointer",
                      marginRight: "10px",
                    },
                    title: "reset",
                  },
                  n.createElement(u.ReloadOutlined, {
                    onClick: function () {
                      S();
                    },
                  })
                ),
                n.createElement(
                  "span",
                  {
                    style: {
                      display: "inline-block",
                      cursor: "pointer",
                      marginRight: "10px",
                    },
                    title: "pause",
                  },
                  n.createElement(u.PauseCircleOutlined, {
                    onClick: function () {
                      k();
                    },
                  })
                ),
                n.createElement(
                  "span",
                  {
                    title: "play",
                    style: {
                      display: "inline-block",
                      marginRight: "20px",
                      cursor: "pointer",
                    },
                    onClick: function () {
                      C();
                    },
                  },
                  n.createElement(u.PlayCircleOutlined, null)
                )
              )
            ),
            g
          ),
          n.createElement(
            "div",
            Object.assign(
              {
                className: "yh-timeline-needle-head-wrap",
                style: {
                  width: "calc(100% -  200px)",
                  borderBottom: "1px solid #dadada",
                  overflow: "hidden",
                  position: "relative",
                  cursor: "crosshair",
                },
              },
              ((v = e.config),
              {
                onDoubleClick:
                  ((y = W(
                    He.mark(function e(t) {
                      var n, i, o, r, a;
                      return He.wrap(function (e) {
                        for (;;)
                          switch ((e.prev = e.next)) {
                            case 0:
                              if (!(n = v.timelineConfig.scrollDom)) {
                                e.next = 15;
                                break;
                              }
                              return (
                                (i = v.timelineNeedleConfig.setNeedle),
                                (o = n.getBoundingClientRect().left),
                                (r = t.clientX + n.scrollLeft),
                                t.persist(),
                                t.stopPropagation(),
                                (e.next = 9),
                                v.timelineNeedleConfig.resetFunc()
                              );
                            case 9:
                              (v.timelineNeedleConfig.status = "stop"),
                                (a = r - o) <= 19
                                  ? ((v.timelineNeedleConfig.current = 0),
                                    (a = 19))
                                  : a > 9960
                                  ? ((v.timelineNeedleConfig.current = 497.05),
                                    (a = 9960))
                                  : (v.timelineNeedleConfig.current =
                                      (a - 19) / 20),
                                i(a),
                                v.blockForceUpdate.forEach(function (e) {
                                  e();
                                }),
                                ct && window.clearInterval(ct);
                            case 15:
                            case "end":
                              return e.stop();
                          }
                      }, e);
                    })
                  )),
                  function (e) {
                    return y.apply(this, arguments);
                  }),
              })
            ),
            n.createElement(
              "div",
              Object.assign(
                {
                  className: "yh-timeline-needle-head",
                  style: {
                    position: "absolute",
                    transform: "translate(-" + d + "px, 0px)",
                    width: 15,
                    height: 22,
                    backgroundColor: "#ff5722",
                    zIndex: 3,
                    left: b - 7.5,
                    transition: "left linear",
                    willChange: "left",
                    borderRadius: "2px",
                    cursor: "col-resize",
                  },
                },
                (function (e, t) {
                  return {
                    onMouseDown:
                      ((n = W(
                        He.mark(function n(i) {
                          var o;
                          return He.wrap(function (n) {
                            for (;;)
                              switch ((n.prev = n.next)) {
                                case 0:
                                  if (
                                    (i.persist(),
                                    i.stopPropagation(),
                                    "start" !== t.timelineNeedleConfig.status &&
                                      t.timelineNeedleConfig.isRefresh)
                                  ) {
                                    n.next = 8;
                                    break;
                                  }
                                  return (
                                    (o = 19),
                                    e(function (e) {
                                      return (o = e), e;
                                    }),
                                    (n.next = 7),
                                    t.timelineNeedleConfig.resetFunc()
                                  );
                                case 7:
                                  e(o);
                                case 8:
                                  e(function (e) {
                                    return (st.origin = e), e;
                                  }),
                                    (st.isDrag = !0),
                                    (st.startX = i.clientX),
                                    t.blockForceUpdate.forEach(function (e) {
                                      e();
                                    }),
                                    ct && window.clearInterval(ct);
                                case 13:
                                case "end":
                                  return n.stop();
                              }
                          }, n);
                        })
                      )),
                      function (e) {
                        return n.apply(this, arguments);
                      }),
                  };
                  var n;
                })(w, e.config)
              )
            ),
            n.createElement("div", {
              className: "yh-timeline-needle",
              style: {
                position: "absolute",
                transform: "translate(-" + d + "px, 0px)",
                width: 2,
                height: "100%",
                backgroundColor: "red",
                zIndex: 2,
                left: b,
                transition: "left linear",
                willChange: "left",
                pointerEvents: "none",
              },
            }),
            n.createElement(
              "div",
              {
                style: {
                  display: "flex",
                  height: 25,
                  alignItems: "flex-end",
                  borderBottom: it,
                  width: 9960,
                  overflow: "hidden",
                  transform: "translate(-" + d + "px, 0px)",
                },
              },
              et.map(function (e) {
                return e % 10 == 0
                  ? n.createElement(
                      "div",
                      {
                        key: e,
                        style: {
                          marginLeft: 19,
                          height: "8px",
                          borderLeft: it,
                          position: "relative",
                        },
                      },
                      n.createElement(
                        "div",
                        {
                          style: {
                            position: "absolute",
                            top: "-20px",
                            transform: "translate(-50%, 0px)",
                          },
                        },
                        e
                      )
                    )
                  : n.createElement("div", {
                      key: e,
                      style: { marginLeft: 19, height: "6px", borderLeft: it },
                    });
              })
            ),
            n.createElement(
              "div",
              {
                onScroll: function (e) {
                  var t = e.target;
                  l(t.scrollTop), m(t.scrollLeft);
                },
                ref: h,
                style: { overflow: "auto", height: "calc(100% - 25px)" },
              },
              p.map(function (e) {
                return n.createElement(
                  "div",
                  {
                    key: e.id,
                    style: {
                      display: "flex",
                      alignItems: "center",
                      paddingLeft: 19,
                      borderBottom: it,
                      width: 9960,
                      position: "relative",
                      overflow: "hidden",
                    },
                    onMouseMove: function (t) {
                      !(function (e, t, n) {
                        if (Pe.isMove) {
                          var i = e.clientX - Pe.startX;
                          t.forEach(function (e) {
                            if (e.uid === Pe.uid) {
                              var t = parseFloat(
                                (e.animationDelay + i / 20).toFixed(1)
                              );
                              (e.animationDelay = t < 0 ? 0 : t),
                                n(function (e) {
                                  return e + 1;
                                });
                            }
                          }),
                            (Pe.startX = e.clientX);
                        } else if (ze.isMove) {
                          var o = e.clientX - ze.startX;
                          t.forEach(
                            ze.left
                              ? function (e) {
                                  if (e.uid === ze.uid) {
                                    var t =
                                        "infinite" === e.animationIterationCount
                                          ? 500
                                          : parseInt(e.animationIterationCount),
                                      i = parseFloat(
                                        (e.animationDelay + o / 20).toFixed(1)
                                      ),
                                      r = parseFloat(
                                        (
                                          e.animationDuration -
                                          (i - e.animationDelay) / t
                                        ).toFixed(1)
                                      );
                                    (e.animationDuration =
                                      i < 0
                                        ? e.animationDuration
                                        : r < 0
                                        ? 0
                                        : r),
                                      (e.animationDelay = i < 0 ? 0 : i),
                                      n(function (e) {
                                        return e + 1;
                                      });
                                  }
                                }
                              : function (e) {
                                  if (e.uid === ze.uid) {
                                    var t =
                                        "infinite" === e.animationIterationCount
                                          ? 500
                                          : parseInt(e.animationIterationCount),
                                      i = parseFloat(
                                        (
                                          e.animationDuration +
                                          o / t / 20
                                        ).toFixed(1)
                                      );
                                    (e.animationDuration = i < 0 ? 0 : i),
                                      n(function (e) {
                                        return e + 1;
                                      });
                                  }
                                }
                          ),
                            (ze.startX = e.clientX);
                        }
                      })(t, e.animate, a);
                    },
                    onMouseLeave: function () {
                      return Be();
                    },
                    onMouseUp: function () {
                      return Be();
                    },
                  },
                  n.createElement(Ke, { animate: e.animate }),
                  et.map(function (e) {
                    return e % 10 == 0
                      ? n.createElement("div", {
                          key: e,
                          style: {
                            marginRight: 199,
                            borderLeft: it,
                            position: "relative",
                            height: 24,
                          },
                        })
                      : null;
                  })
                );
              })
            )
          )
        )
      )
    )
  );
}
var ft = function (e) {
  var t,
    n = e.getStore(),
    i = e.getScaleState();
  return {
    onMouseMove: function (o) {
      var r;
      if (!X() || !se.state) {
        var a = null == (r = Q.item) ? void 0 : r.id;
        if (a && Q.isDrag) {
          var c = n.getData().block.find(function (e) {
            return e.id === a;
          });
          if ("static" === (null == c ? void 0 : c.position)) return;
          var s,
            l = e.getFocusState().blocks.length > 1,
            u = o.clientX,
            f = o.clientY,
            d = Q.startY,
            m = i.value,
            g = Math.round((u - Q.startX) / m),
            p = Math.round((f - d) / m);
          if (t !== Q.item) {
            var h = _(n.getData().block);
            (t = Q.item),
              (s = h.map(function (e) {
                return (
                  e.focus &&
                    "static" !== e.position &&
                    (l
                      ? ((e.left = Math.round(e.left + g)),
                        (e.top = Math.round(e.top + p)))
                      : ((e.left = Math.round(Q.itemX + g)),
                        (e.top = Math.round(Q.itemY + p)))),
                  e
                );
              }));
          } else
            s = n.getData().block.map(function (e) {
              return (
                e.focus &&
                  "static" !== e.position &&
                  (l
                    ? ((e.left = Math.round(e.left + g)),
                      (e.top = Math.round(e.top + p)))
                    : ((e.left = Math.round(Q.itemX + g)),
                      (e.top = Math.round(Q.itemY + p)))),
                e
              );
            });
          n.setData(K({}, n.getData(), { block: s })),
            l && ((Q.startX = u), (Q.startY = f));
        }
        !(function (e, t) {
          var n,
            i = t.getScaleState(),
            o = t.getStore();
          if (
            xe.isResize &&
            xe.item &&
            null != (n = xe.ref) &&
            n.current &&
            xe.currentTarget
          ) {
            var r = e.clientX,
              a = e.clientY,
              c = i.value,
              s = z();
            if (!s) return;
            var l = s.getBoundingClientRect(),
              u = xe.item.rotate.value,
              f = { x: (r - l.left) / c, y: (a - l.top) / c },
              d = xe.ref.current.getBoundingClientRect(),
              m = { width: d.width, height: d.height },
              g = xe.symmetricPoint,
              p = _(o.getData()),
              h = xe.item.id,
              v = p.block.map(function (e) {
                return (
                  e.id === h &&
                    (function (e, t, n, i, o, r) {
                      switch (xe.direction) {
                        case "lt":
                          !(function (e, t, n, i) {
                            var o = be(n, i),
                              r = we(n, o, -t),
                              a = we(i, o, -t),
                              c = a.x - r.x,
                              s = a.y - r.y;
                            c > 0 &&
                              s > 0 &&
                              ((e.width = Math.round(c)),
                              (e.height = Math.round(s)),
                              (e.left = Math.round(r.x)),
                              (e.top = Math.round(r.y)));
                          })(t, n, i, o);
                          break;
                        case "r":
                          !(function (e, t, n, i, o) {
                            var r = xe.curPosition,
                              a = we(n, r, -t),
                              c = we({ x: a.x, y: r.y }, r, t),
                              s = Math.sqrt(
                                Math.pow(c.x - i.x, 2) + Math.pow(c.y - i.y, 2)
                              );
                            if (s > 0) {
                              var l = {
                                  x: c.x - (c.x - i.x) / 2,
                                  y: c.y + (i.y - c.y) / 2,
                                },
                                u =
                                  "number" == typeof e.height
                                    ? e.height
                                    : o.height;
                              (e.height = u),
                                (e.width = Math.round(s)),
                                (e.top = Math.round(l.y - u / 2)),
                                (e.left = Math.round(l.x - s / 2));
                            }
                          })(t, n, i, o, r);
                          break;
                        case "b":
                          !(function (e, t, n, i, o) {
                            var r = xe.curPosition,
                              a = we(n, r, -t),
                              c = we({ x: r.x, y: a.y }, r, t),
                              s = Math.sqrt(
                                Math.pow(c.x - i.x, 2) + Math.pow(c.y - i.y, 2)
                              );
                            if (s > 0) {
                              var l = {
                                  x: c.x - (c.x - i.x) / 2,
                                  y: c.y + (i.y - c.y) / 2,
                                },
                                u =
                                  "number" == typeof e.width
                                    ? e.width
                                    : o.width;
                              (e.width = u),
                                (e.height = Math.round(s)),
                                (e.top = Math.round(l.y - s / 2)),
                                (e.left = Math.round(l.x - u / 2));
                            }
                          })(t, n, i, o, r);
                          break;
                        case "l":
                          !(function (e, t, n, i, o) {
                            var r = xe.curPosition,
                              a = we(n, r, -t),
                              c = we({ x: a.x, y: r.y }, r, t),
                              s = Math.sqrt(
                                Math.pow(c.x - i.x, 2) + Math.pow(c.y - i.y, 2)
                              );
                            if (s > 0) {
                              var l = {
                                  x: c.x - (c.x - i.x) / 2,
                                  y: c.y + (i.y - c.y) / 2,
                                },
                                u =
                                  "number" == typeof e.height
                                    ? e.height
                                    : o.height;
                              (e.height = u),
                                (e.width = Math.round(s)),
                                (e.top = Math.round(l.y - u / 2)),
                                (e.left = Math.round(l.x - s / 2));
                            }
                          })(t, n, i, o, r);
                          break;
                        case "t":
                          !(function (e, t, n, i, o) {
                            var r = xe.curPosition,
                              a = we(n, r, -t),
                              c = we({ x: r.x, y: a.y }, r, t),
                              s = Math.sqrt(
                                Math.pow(c.x - i.x, 2) + Math.pow(c.y - i.y, 2)
                              );
                            if (s > 0) {
                              var l = {
                                  x: c.x - (c.x - i.x) / 2,
                                  y: c.y + (i.y - c.y) / 2,
                                },
                                u =
                                  "number" == typeof e.width
                                    ? e.width
                                    : o.width;
                              (e.width = u),
                                (e.height = Math.round(s)),
                                (e.top = Math.round(l.y - s / 2)),
                                (e.left = Math.round(l.x - u / 2));
                            }
                          })(t, n, i, o, r);
                          break;
                        case "rb":
                          !(function (e, t, n, i) {
                            var o = be(n, i),
                              r = we(i, o, -t),
                              a = we(n, o, -t),
                              c = a.x - r.x,
                              s = a.y - r.y;
                            c > 0 &&
                              s > 0 &&
                              ((e.width = Math.round(c)),
                              (e.height = Math.round(s)),
                              (e.left = Math.round(r.x)),
                              (e.top = Math.round(r.y)));
                          })(t, n, i, o);
                          break;
                        case "rt":
                          !(function (e, t, n, i) {
                            var o = be(n, i),
                              r = we(n, o, -t),
                              a = we(i, o, -t),
                              c = r.x - a.x,
                              s = a.y - r.y;
                            c > 0 &&
                              s > 0 &&
                              ((e.width = Math.round(c)),
                              (e.height = Math.round(s)),
                              (e.left = Math.round(a.x)),
                              (e.top = Math.round(r.y)));
                          })(t, n, i, o);
                          break;
                        case "lb":
                          !(function (e, t, n, i) {
                            var o = be(n, i),
                              r = we(i, o, -t),
                              a = we(n, o, -t),
                              c = r.x - a.x,
                              s = a.y - r.y;
                            c > 0 &&
                              s > 0 &&
                              ((e.width = Math.round(c)),
                              (e.height = Math.round(s)),
                              (e.left = Math.round(a.x)),
                              (e.top = Math.round(r.y)));
                          })(t, n, i, o);
                      }
                    })(0, e, u, f, g, m),
                  e
                );
              });
            (xe.startX = r), (xe.startY = a), o.setData(K({}, p, { block: v }));
          }
        })(o, e),
          (function (e, t) {
            var n,
              i = t.getStore();
            if (Xe.isRotate && Xe.item && null != (n = Xe.ref) && n.current) {
              var o = e.clientX,
                r = e.clientY,
                a = Xe.startX,
                c = Xe.startY,
                s = Xe.ref.current.getBoundingClientRect(),
                l = s.left + s.width / 2,
                u = s.top + s.height / 2,
                f = Math.atan2(c - u, a - l) / (Math.PI / 180),
                d = Math.atan2(r - u, o - l) / (Math.PI / 180),
                m = Xe.item.rotate.value + d - f,
                g = _(i.getData()),
                p = Xe.item.id,
                h = g.block.map(function (e) {
                  return e.id === p && (e.rotate.value = m), e;
                });
              i.setData(K({}, g, { block: h }));
            }
          })(o, e),
          oe.selectDiv && re(o);
      }
    },
  };
};
function dt(e, t, n, i, o, r, a) {
  var c = e.top,
    s = e.height,
    l = e.left,
    u = e.width,
    f = t.top,
    d = t.height,
    m = t.left,
    g = t.width,
    p = 0,
    h = 0;
  switch (a) {
    case "left":
      r.dirtyY
        ? o <= 1 && n.y.push(m)
        : (n.y.push(m), (h = m - l), (r.dirtyY = !0));
      break;
    case "right":
      r.dirtyY
        ? o <= 1 && n.y.push(m + g)
        : (n.y.push(m + g), (h = m + g - l - u), (r.dirtyY = !0));
      break;
    case "l-r":
      r.dirtyY
        ? o <= 1 && n.y.push(m + g)
        : (n.y.push(m + g), (h = m + g - l), (r.dirtyY = !0));
      break;
    case "r-l":
      r.dirtyY
        ? o <= 1 && n.y.push(m)
        : (n.y.push(m), (h = m - (l + u)), (r.dirtyY = !0));
      break;
    case "top":
      r.dirtyX
        ? o <= 1 && n.x.push(f)
        : (n.x.push(f), (p = f - c), (r.dirtyX = !0));
      break;
    case "bottom":
      r.dirtyX
        ? o <= 1 && n.x.push(f + d)
        : (n.x.push(f + d), (p = f + d - c - s), (r.dirtyX = !0));
      break;
    case "t-b":
      r.dirtyX
        ? o <= 1 && n.x.push(f + d)
        : (n.x.push(f + d), (p = f + d - c), (r.dirtyX = !0));
      break;
    case "b-t":
      r.dirtyX
        ? o <= 1 && n.x.push(f)
        : (n.x.push(f), (p = f - (c + s)), (r.dirtyX = !0));
  }
  ve.isAbsorb &&
    ((i.top = Math.round(i.top + p)), (i.left = Math.round(i.left + h)));
}
function mt(e, t, n) {
  var i = e.top,
    o = e.height,
    r = e.left,
    a = e.width,
    c = t.top,
    s = t.height,
    l = t.left,
    u = t.width;
  Math.abs(c - i) <= 1 || Math.abs(c - (i + o)) <= 1
    ? n.x.push(c)
    : (Math.abs((c + s - i) / 2) <= 1 || Math.abs((c + s - i - o) / 2) <= 1) &&
      n.x.push(c + s),
    Math.abs(l - r) <= 1 || Math.abs(l - (r + a)) <= 1
      ? n.y.push(l)
      : (Math.abs(l + u - r) <= 1 || Math.abs(l + u - r - a) <= 1) &&
        n.y.push(l + u);
}
function gt(e) {
  return Math.abs(Math.cos(U(e)));
}
function pt(e) {
  return Math.abs(Math.sin(U(e)));
}
function ht(e, t, n, i, o) {
  var r = { left: i, width: t, height: n, right: i + t, top: o, bottom: o + n };
  if (0 !== e) {
    var a = r.width * gt(e) + r.height * pt(e);
    (r.left += (r.width - a) / 2), (r.right = r.left + a);
    var c = r.height * gt(e) + r.width * pt(e);
    (r.top -= (c - r.height) / 2),
      (r.bottom = r.top + c),
      (r.width = a),
      (r.height = c);
  } else (r.bottom = r.top + r.height), (r.right = r.left + r.width);
  return r;
}
function vt(e) {
  return n.createElement("div", {
    className: "yh-markline",
    style: {
      borderTop: "1px " + ve.borderStyle + " " + ve.borderColor,
      position: "absolute",
      width: "100%",
      top: e.top,
      display: e.display,
      zIndex: 9999,
    },
  });
}
function yt(e) {
  return n.createElement("div", {
    className: "yh-markline",
    style: {
      borderLeft: "1px " + ve.borderStyle + " " + ve.borderColor,
      position: "absolute",
      height: "100%",
      left: e.left,
      display: e.display,
      zIndex: 9999,
    },
  });
}
function xt(e) {
  var i = (function (e, t) {
      var n,
        i,
        o = e.getStore(),
        r = { x: [], y: [] };
      if (
        "static" === (null == (n = Q.item) ? void 0 : n.position) ||
        "relative" === (null == (i = Q.item) ? void 0 : i.position)
      )
        return r;
      var a = Q.item,
        c = Q.ref;
      if (a && c && c.current && Q.isDrag) {
        var s = o.getData().block.find(function (e) {
          return e.id === a.id;
        });
        if (!s) return r;
        if (!z()) return r;
        if ("number" != typeof s.width || "number" != typeof s.height) return r;
        ve.marklineUnfocus ||
          (ve.marklineUnfocus = o.getData().block.filter(function (e) {
            return (
              !1 === e.focus &&
              "static" !== e.position &&
              "relative" !== e.position
            );
          }));
        var l = s.left,
          u = s.top,
          f = ht(s.rotate.value, s.width, s.height, l, u);
        if ("number" != typeof l || "number" != typeof u) return r;
        var d = ve.marklineUnfocus,
          m = d.length;
        if (Ye.cache) {
          if (!(e.getFocusState().blocks.length > 1)) {
            Ye.sortLeft ||
              (Ye.sortLeft = Object.values(Ye.cache).sort(function (e, t) {
                return e.left - t.left;
              })),
              Ye.sortTop ||
                (Ye.sortTop = Object.values(Ye.cache).sort(function (e, t) {
                  return e.top - t.top;
                })),
              Ye.sortBottom ||
                (Ye.sortBottom = Object.values(Ye.cache).sort(function (e, t) {
                  return e.bottom - t.bottom;
                })),
              Ye.sortRight ||
                (Ye.sortRight = Object.values(Ye.cache).sort(function (e, t) {
                  return e.right - t.right;
                }));
            var g = { dirtyX: !1, dirtyY: !1 },
              p = q(f.left, Ye.sortLeft, "left", ve.indent);
            p && dt(f, p[0], r, s, p[1], g, "left");
            var h = q(f.left, Ye.sortRight, "right", ve.indent);
            h && dt(f, h[0], r, s, h[1], g, "l-r");
            var v = q(f.right, Ye.sortLeft, "left", ve.indent);
            v && dt(f, v[0], r, s, v[1], g, "r-l");
            var y = q(f.top, Ye.sortBottom, "bottom", ve.indent);
            y && dt(f, y[0], r, s, y[1], g, "t-b");
            var x = q(f.bottom, Ye.sortTop, "top", ve.indent);
            x && dt(f, x[0], r, s, x[1], g, "b-t");
            var b = q(f.top, Ye.sortTop, "top", ve.indent);
            b && dt(f, b[0], r, s, b[1], g, "top");
            var w = q(f.right, Ye.sortRight, "right", ve.indent);
            w && dt(f, w[0], r, s, w[1], g, "right");
            var M = q(f.bottom, Ye.sortBottom, "bottom", ve.indent);
            M && dt(f, M[0], r, s, M[1], g, "bottom");
          }
        } else
          for (var E = 0; E < m; E++) {
            var C = d[E],
              S = null == C ? void 0 : C.left,
              k = null == C ? void 0 : C.top,
              D = null == C ? void 0 : C.width,
              N = null == C ? void 0 : C.height;
            if (
              "number" == typeof S &&
              "number" == typeof k &&
              "number" == typeof D &&
              "number" == typeof N
            ) {
              var I,
                L = ht(C.rotate.value, D, N, S, k);
              Ye.cache
                ? (Ye.cache[C.id] = L)
                : (Ye.cache = (((I = {})[C.id] = L), I)),
                mt(f, L, r);
            }
          }
        t && e.refreshIframe();
      }
      return r;
    })(e.config, e.iframe),
    o = t.useMemo(
      function () {
        return n.createElement(
          n.Fragment,
          null,
          i.x.map(function (e, t) {
            return n.createElement(vt, { key: t, top: e });
          }),
          i.y.map(function (e, t) {
            return n.createElement(yt, { key: t, left: e });
          })
        );
      },
      [i]
    );
  return n.createElement(n.Fragment, null, o);
}
function bt() {
  var e = window.navigator.userAgent.match(
    /(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i
  );
  return [
    e || window.innerWidth < 500 ? window.innerWidth : 375,
    e || window.screen.availHeight < 667 ? window.screen.availHeight : 667,
  ];
}
function wt(e) {
  void 0 === e && (e = 375);
  var t = "string" == typeof e ? parseFloat(e) : e;
  return (bt()[0] / 375) * t;
}
function Mt(e) {
  void 0 === e && (e = 667);
  var t = "string" == typeof e ? parseFloat(e) : e;
  return (bt()[0] / 375) * t;
}
function Et(e) {
  var i = t.useState(null),
    o = i[0],
    r = i[1],
    a = t.useState({
      top: e.data.top,
      left: e.data.left,
      height: e.data.height,
      width: e.data.width,
    }),
    c = a[0],
    l = a[1];
  t.useEffect(
    function () {
      var t = function () {
          return e.config.getComponentRegister().getComp(e.data.name);
        },
        n = t(),
        i = function () {},
        o = K({}, e.data);
      return (
        "preview" === e.context &&
          (o = K({}, e.data, {
            top: c.top,
            left: c.left,
            height: c.height,
            width: c.width,
          })),
        n
          ? r(n.render(o, e.context, e.config.getStore(), e.config))
          : (i = e.config.getComponentRegister().on(e.data.name, function () {
              var n = t();
              r(n.render(o, e.context, e.config.getStore(), e.config)), i();
            })),
        function () {
          i();
        }
      );
    },
    [e.data, e.context, e.config, c]
  );
  var u = t.useRef(null),
    f = t.useMemo(
      function () {
        return K(
          {},
          (function (e, t, n) {
            var i = n.getStore();
            return {
              onMouseDown: function (o) {
                if ((o.stopPropagation(), F.includes(e.name)))
                  fe(n).onMouseDown(o);
                else {
                  if (
                    (e.id &&
                      Q.lastClick &&
                      e.id !== Q.lastClick.id &&
                      se.unmountContextMenu(),
                    (function (e, t, n) {
                      var i = n.getStore(),
                        o = _(i.getData()),
                        r = n.getFocusState();
                      if (e.shiftKey) {
                        var a = o.block.map(function (e) {
                          return (
                            e.id === t.id && ((e.focus = !0), r.blocks.push(t)),
                            e
                          );
                        });
                        i.setData(K({}, o, { block: a }));
                      } else {
                        var c = [],
                          s = o.block.map(function (e) {
                            return (
                              e.id === t.id
                                ? (c.push(t), (e.focus = !0))
                                : (e.focus = !1),
                              e
                            );
                          });
                        (r.blocks = c), i.setData(K({}, o, { block: s }));
                      }
                    })(o, e, n),
                    n.timelineConfig.autoFocus && n.timelineConfig.scrollDom)
                  ) {
                    var r = i.getData().block.findIndex(function (t) {
                      return t.id === e.id;
                    });
                    r >= 0 && (n.timelineConfig.scrollDom.scrollTop = 25 * r);
                  }
                  e.canDrag &&
                    ((Q.lastClick = e),
                    "static" !== e.position &&
                      (t.current &&
                        ((t.current.style.cursor = "move"),
                        (t.current.style.willChange =
                          "left,right,width,height")),
                      (Q.startX = Math.round(o.clientX)),
                      (Q.startY = Math.round(o.clientY)),
                      (Q.item = e),
                      (Q.itemX = e.left),
                      (Q.itemY = e.top),
                      (Q.isDrag = !0),
                      (Q.ref = t),
                      (Q.current = i.getIndex())));
                }
              },
            };
          })(e.data, u, e.config)
        );
      },
      [e.data, e.config]
    );
  t.useEffect(
    function () {
      var t = function () {
        var t = (function (e, t, n, i, o) {
          if (o) {
            var r,
              a,
              c = wt(t);
            return (
              (r = "string" == typeof n || void 0 === n ? n : Mt(n)),
              (a = "string" == typeof i || void 0 === i ? i : wt(i)),
              {
                top:
                  e >= 667
                    ? "number" == typeof r
                      ? Mt() - r
                      : Mt()
                    : "number" == typeof n &&
                      e >= 667 - n &&
                      "number" == typeof r
                    ? Mt() - r
                    : Mt(e),
                left: c,
                height: r,
                width: a,
              }
            );
          }
          return {
            top: Mt(e),
            left: wt(t),
            height: "string" == typeof n || void 0 === n ? n : Mt(n),
            width: "string" == typeof i || void 0 === i ? i : wt(i),
          };
        })(e.data.top, e.data.left, e.data.height, e.data.width, e.data.fixed);
        l({ top: t.top, left: t.left, width: t.width, height: t.height });
      };
      return (
        t(),
        window.addEventListener("resize", t),
        function () {
          window.removeEventListener("resize", t);
        }
      );
    },
    [
      c.height,
      c.left,
      c.top,
      c.width,
      e.data.height,
      e.data.left,
      e.data.top,
      e.data.width,
      e.data.fixed,
    ]
  );
  var d = t.useState(0),
    m = d[0],
    g = d[1];
  t.useEffect(
    function () {
      var t = function () {
        g(function (e) {
          return e + 1;
        });
      };
      return (
        e.config.blockForceUpdate.push(t),
        function () {
          e.config.blockForceUpdate = e.config.blockForceUpdate.filter(
            function (e) {
              return e !== t;
            }
          );
        }
      );
    },
    [g, e.config]
  );
  var p = t.useMemo(
      function () {
        var t = (function (e, t) {
          void 0 === t && (t = { delay: 0, isPause: !1 });
          var n = "",
            i = "";
          return (
            e.forEach(function (e) {
              (n =
                ("" === n ? n : n + ",") +
                (e.animationDuration + "s ") +
                e.animationTimingFunction +
                " " +
                (e.animationDelay - t.delay).toFixed(1) +
                "s " +
                e.animationIterationCount +
                " forwards " +
                (t.isPause ? "paused" : "running") +
                " " +
                e.animationName),
                (i =
                  ("" === i ? i : i + ",") +
                  (e.animationDuration + "s ") +
                  e.animationTimingFunction +
                  " " +
                  e.animationDelay +
                  "s " +
                  e.animationIterationCount +
                  " forwards running " +
                  e.animationName);
            }),
            [i, n]
          );
        })(e.data.animate, {
          isPause: "start" !== e.config.timelineNeedleConfig.status,
          delay:
            "stop" === e.config.timelineNeedleConfig.status
              ? e.config.timelineNeedleConfig.current
              : 0,
        });
        return [{ animation: t[0] }, { animation: t[1] }];
      },
      [e.data.animate, e.config.timelineNeedleConfig, m]
    ),
    h = p[0],
    v = p[1];
  return t.useMemo(
    function () {
      if (o && "edit" === e.context) {
        var t = e.data.canDrag ? { pointerEvents: "none" } : {};
        return n.createElement(
          "div",
          Object.assign(
            {
              ref: u,
              className:
                e.data.focus && "static" !== e.data.position
                  ? Z.yh_block_focus
                  : "",
              style: {
                position: e.data.position,
                top: e.data.top,
                left: e.data.left,
                width: e.data.width,
                height: e.data.height,
                zIndex: e.data.zIndex,
                display:
                  "boolean" == typeof e.data.canSee
                    ? e.data.canSee
                      ? e.data.display
                      : "none"
                    : e.data.display,
                opacity: e.iframe ? 0 : 1,
                transform: "rotate(" + e.data.rotate.value + "deg)",
              },
            },
            f,
            {
              onContextMenu: function (t) {
                "modalMask" !== e.data.name &&
                  (function (e, t, n) {
                    e.preventDefault();
                    var i = n.getScaleState();
                    se.unmountContextMenu(),
                      (se.state = !0),
                      (se.observer = new MutationObserver(function (e) {
                        if (X()) se.unmountContextMenu();
                        else
                          for (var t, n = J(e); !(t = n()).done; ) {
                            var o = t.value;
                            if ("attributes" === o.type) {
                              var r = i.value,
                                a = parseFloat(o.target.style.left),
                                c = parseFloat(o.target.style.top),
                                s = (a - se.initLeft) * r,
                                l = (c - se.initTop) * r;
                              (se.initLeft = a),
                                (se.initTop = c),
                                (se.left = se.left + s),
                                (se.top = se.top + l),
                                se.forceUpdate();
                            }
                          }
                      })),
                      t.current &&
                        ((se.initTop = parseFloat(t.current.style.top)),
                        (se.initLeft = parseFloat(t.current.style.left)),
                        se.observer.observe(t.current, { attributes: !0 })),
                      (se.left = e.clientX),
                      (se.top = e.clientY),
                      se.menu ||
                        ((se.menu = document.createElement("div")),
                        document.body && document.body.appendChild(se.menu)),
                      se.parent || (se.parent = document.createElement("div")),
                      se.menu.appendChild(se.parent),
                      s.render(se.contextMenu, se.parent);
                  })(t, u, e.config);
              },
            }
          ),
          "static" !== e.data.position &&
            n.createElement("div", { style: K({}, t, v) }, o),
          "static" === e.data.position &&
            "inline" !== e.data.display &&
            n.createElement(
              "div",
              { style: K({ pointerEvents: "none" }, v) },
              o
            ),
          "static" === e.data.position &&
            "inline" === e.data.display &&
            n.createElement(
              "span",
              { style: K({ pointerEvents: "none" }, v) },
              o
            ),
          n.createElement(ke, { data: e.data, config: e.config, rect: u }),
          n.createElement(Te, { data: e.data, config: e.config, rect: u }),
          n.createElement(je, { data: e.data, config: e.config, rect: u })
        );
      }
      var i = {
        position: e.data.fixed ? "fixed" : e.data.position,
        top: c.top,
        left: c.left,
        width: c.width,
        height: c.height,
        zIndex: e.data.zIndex,
        display: e.data.display,
        transform: "rotate(" + e.data.rotate.value + "deg)",
      };
      return n.createElement(
        n.Fragment,
        null,
        "static" !== e.data.position &&
          n.createElement(
            "div",
            { style: i },
            n.createElement("div", { style: K({}, h) }, o)
          ),
        "static" === e.data.position &&
          "inline" !== e.data.display &&
          n.createElement(
            "div",
            { style: i },
            n.createElement("div", { style: K({}, h) }, o)
          ),
        "static" === e.data.position &&
          "inline" === e.data.display &&
          n.createElement(
            "span",
            { style: i },
            n.createElement("span", { style: K({}, h) }, o)
          )
      );
    },
    [
      o,
      e.context,
      e.data,
      e.iframe,
      e.config,
      f,
      v,
      c.top,
      c.left,
      c.width,
      c.height,
      h,
    ]
  );
}
function Ct(e) {
  var i,
    o,
    r,
    a,
    c,
    s,
    l,
    u,
    f = e.editContainerStyle,
    d = e.previewContainerStyle,
    m = e.config.getScaleState(),
    g = t.useMemo(
      function () {
        return "edit" === e.context
          ? "scale(" +
              m.value +
              ") translate(" +
              _e.needX +
              "px, " +
              _e.needY +
              "px)"
          : void 0;
      },
      [e.context, m]
    ),
    p = function () {
      return e.config.getStore().isEdit()
        ? "rgba(255,255,255,1)"
        : e.state.globalState.containerColor;
    },
    h = t.useState(0)[1];
  (e.config.containerForceUpdate = function () {
    h(function (e) {
      return e + 1;
    });
  }),
    t.useEffect(
      function () {
        return (
          "preview" === e.context &&
            (e.config.onMounted(),
            e.config.onMountedFn.forEach(function (e) {
              return e();
            })),
          function () {
            "preview" === e.context &&
              (e.config.destroyed(),
              e.config.destroyedFn.forEach(function (e) {
                return e();
              }));
          }
        );
      },
      [e.config, e.context]
    );
  var v = function () {
    return n.createElement(
      "div",
      { className: Z.minwx },
      n.createElement(
        "div",
        null,
        n.createElement(
          "svg",
          {
            t: "1652778150874",
            class: "icon",
            viewBox: "0 0 1024 1024",
            version: "1.1",
            xmlns: "http://www.w3.org/2000/svg",
            "p-id": "2782",
            width: "8",
            height: "8",
          },
          n.createElement("path", {
            d: "M480 480m-288 0a4.5 4.5 0 1 0 576 0 4.5 4.5 0 1 0-576 0Z",
            "p-id": "2783",
            fill: "#ffffff",
          })
        ),
        n.createElement(
          "svg",
          {
            t: "1652778150874",
            class: "icon",
            viewBox: "0 0 1024 1024",
            version: "1.1",
            xmlns: "http://www.w3.org/2000/svg",
            "p-id": "2782",
            width: "12",
            height: "12",
          },
          n.createElement("path", {
            d: "M480 480m-288 0a4.5 4.5 0 1 0 576 0 4.5 4.5 0 1 0-576 0Z",
            "p-id": "2783",
            fill: "#ffffff",
          })
        ),
        n.createElement(
          "svg",
          {
            t: "1652778150874",
            class: "icon",
            viewBox: "0 0 1024 1024",
            version: "1.1",
            xmlns: "http://www.w3.org/2000/svg",
            "p-id": "2782",
            width: "8",
            height: "8",
          },
          n.createElement("path", {
            d: "M480 480m-288 0a4.5 4.5 0 1 0 576 0 4.5 4.5 0 1 0-576 0Z",
            "p-id": "2783",
            fill: "#ffffff",
          })
        )
      ),
      n.createElement(
        "div",
        null,
        n.createElement(
          "svg",
          {
            t: "1652775167764",
            class: "icon",
            viewBox: "0 0 1024 1024",
            version: "1.1",
            xmlns: "http://www.w3.org/2000/svg",
            "p-id": "2090",
            width: "20",
            height: "20",
          },
          n.createElement("path", {
            d: "M512 64c60.5 0 119.2 11.8 174.4 35.2 53.3 22.6 101.3 54.9 142.4 96 41.2 41.2 73.5 89.1 96 142.4C948.2 392.8 960 451.5 960 512s-11.8 119.2-35.2 174.4c-22.6 53.3-54.9 101.3-96 142.4-41.2 41.2-89.1 73.5-142.4 96C631.2 948.2 572.5 960 512 960s-119.2-11.8-174.4-35.2c-53.3-22.6-101.3-54.9-142.4-96-41.2-41.2-73.5-89.1-96-142.4C75.8 631.2 64 572.5 64 512s11.8-119.2 35.2-174.4c22.6-53.3 54.9-101.3 96-142.4s89.1-73.5 142.4-96C392.8 75.8 451.5 64 512 64m0-64C229.2 0 0 229.2 0 512s229.2 512 512 512 512-229.2 512-512S794.8 0 512 0z",
            "p-id": "2091",
            fill: "#ffffff",
          }),
          n.createElement("path", {
            d: "M512 512m-96 0a96 96 0 1 0 192 0 96 96 0 1 0-192 0Z",
            "p-id": "2092",
            fill: "#ffffff",
          })
        )
      )
    );
  };
  return n.createElement(
    n.Fragment,
    null,
    "edit" === e.context &&
      n.createElement(
        n.Fragment,
        null,
        n.createElement(
          "div",
          {
            style: {
              position: "absolute",
              height: e.state.container.height + 60 + "px",
              width: e.state.container.width + "px",
              transform:
                "scale(" +
                m.value +
                ") translate(" +
                _e.needX +
                "px, " +
                _e.needY +
                "px)",
            },
          },
          n.createElement(
            "div",
            { style: { display: "flex" } },
            n.createElement(
              "div",
              Object.assign(
                {
                  id: "yh-container",
                  className: Z.yh_container,
                  style: K(
                    {
                      height: e.state.container.height + "px",
                      width: e.state.container.width + "px",
                      backgroundColor: p(),
                      position: "relative",
                      overflow: e.config.containerOverFlow
                        ? "hidden"
                        : "visible",
                      cursor: "default",
                      lineHeight:
                        null !=
                        (i =
                          null == (o = e.state.globalState)
                            ? void 0
                            : o.lineHeight)
                          ? i
                          : 1.575,
                      fontSize:
                        null !=
                        (r =
                          null == (a = e.state.globalState)
                            ? void 0
                            : a.fontSize)
                          ? r
                          : 14,
                    },
                    f
                  ),
                },
                "edit" === e.context ? he(e.config) : null,
                "edit" === e.context ? ft(e.config) : null,
                "edit" === e.context ? fe(e.config) : null
              ),
              e.state.container.isMinwx && v(),
              "edit" === e.context &&
                n.createElement(xt, { config: e.config, iframe: !1 }),
              e.state.block.map(function (t) {
                return n.createElement(Et, {
                  config: e.config,
                  key: t.id,
                  data: t,
                  context: e.context,
                });
              })
            )
          ),
          n.createElement(
            "div",
            {
              style: {
                height: "50px",
                display: "flex",
                justifyContent: "center",
                alignItems: "center",
                width: e.state.container.width + "px",
              },
            },
            n.createElement(
              "div",
              {
                style: { fontSize: "20px", cursor: "s-resize" },
                onMouseDown: function (t) {
                  return Le(t, e.config);
                },
              },
              e.config.getConfig().containerIcon
            )
          )
        )
      ),
    "preview" === e.context &&
      n.createElement(
        "div",
        {
          id: "yh-container-preview",
          className: Z.yh_container_preview,
          style: K(
            {
              height: Mt(e.state.container.height) + "px",
              width: e.state.container.width + "px",
              position: "relative",
              overflow: "hidden",
              top: "20px",
              border: "2px solid #ccc",
              boxShadow: "0 0 10px #ccc",
              backgroundColor: p(),
              transform: g,
              lineHeight:
                null !=
                (c = null == (s = e.state.globalState) ? void 0 : s.lineHeight)
                  ? c
                  : 1.575,
              fontSize:
                null !=
                (l = null == (u = e.state.globalState) ? void 0 : u.fontSize)
                  ? l
                  : 14,
            },
            d
          ),
        },
        e.state.container.isMinwx && v(),
        e.state.block.map(function (t) {
          return n.createElement(Et, {
            key: t.id,
            config: e.config,
            data: t,
            context: e.context,
          });
        })
      )
  );
}
function St(e) {
  var i = t.useState(e.initColor),
    o = i[0],
    r = i[1],
    a = t.useState(!1),
    c = a[0],
    s = a[1];
  return n.createElement(
    n.Fragment,
    null,
    n.createElement(
      "div",
      { style: { position: "relative", display: "flex" } },
      n.createElement(
        "div",
        {
          onClick: function () {
            s(function (e) {
              return !e;
            });
          },
          style: {
            background: "#fff",
            borderRadius: "1px",
            boxShadow: "0 0 0 1px rgba(0,0,0,.1)",
            cursor: "pointer",
            display: "inline-block",
          },
        },
        n.createElement("div", {
          style: {
            width: "20px",
            height: "20px",
            borderRadius: "2px",
            background:
              "rgba(" + o.r + ", " + o.g + ", " + o.b + ", " + o.a + ")",
          },
        })
      ),
      c &&
        n.createElement(
          n.Fragment,
          null,
          n.createElement(
            "div",
            {
              style: {
                position: "absolute",
                zIndex: 2e3,
                transform: "translate(-100%, 0px)",
              },
            },
            n.createElement(M.SketchPicker, {
              color: o,
              onChange: function (t) {
                var n = t.rgb;
                r(n), e.onChange(n);
              },
            })
          ),
          n.createElement("div", {
            style: {
              position: "fixed",
              top: "0px",
              right: "0px",
              bottom: "0px",
              left: "0px",
              zIndex: 1e3,
            },
            onClick: function () {
              return s(!1);
            },
          })
        )
    )
  );
}
var kt = t.memo(St),
  Dt = { display: "flex", alignItems: "center", justifyContent: "flex-end" },
  Nt = {
    display: "flex",
    alignItems: "center",
    userSelect: "none",
    height: 32,
  },
  It = function () {
    le();
  },
  Lt = {
    increase: function (e, t) {
      void 0 === e && (e = 0.1);
      var n = t.getStore(),
        i = t.getScaleState();
      return (
        i.value < i.maxValue &&
          (It(), (i.value = i.value + e), n.forceUpdate(), t.refreshIframe()),
        i.value
      );
    },
    decrease: function (e, t) {
      void 0 === e && (e = 0.1);
      var n = t.getStore(),
        i = t.getScaleState();
      return (
        It(),
        i.value > i.minValue &&
          ((i.value = i.value - e), n.forceUpdate(), t.refreshIframe()),
        i.value
      );
    },
  },
  Ft = function (e, t) {
    return {
      onWheel: function (n) {
        document.querySelector(".ant-modal-mask") ||
          (n.deltaY > 0
            ? (It(),
              t.value > t.minValue &&
                ((t.value = t.value - 0.1),
                e.sendParent({ type: "update", column: "scale", data: t })))
            : (It(),
              t.value < t.maxValue &&
                ((t.value = t.value + 0.1),
                e.sendParent({ type: "update", column: "scale", data: t }))));
      },
    };
  };
function Rt(e) {
  var i = t.useRef(null),
    o = t.useRef(null),
    r = t.useState(0),
    a = r[0],
    c = r[1],
    s = t.useState(0),
    l = s[0],
    u = s[1],
    f = e.config.getScaleState().value;
  return (
    t.useEffect(
      function () {
        var e = setTimeout(function () {
          if (i.current) {
            var e = i.current.getBoundingClientRect().width,
              t = Math.ceil(e / 10 / f);
            t < Math.pow(2, 32) - 1 && c(t);
          }
          if (o.current) {
            var n = o.current.getBoundingClientRect().height,
              r = Math.ceil(n / 10 / f);
            r < Math.pow(2, 32) - 1 && u(r);
          }
        }, 300);
        return function () {
          clearTimeout(e);
        };
      },
      [e.config, e.config.collapsed, f]
    ),
    n.createElement(
      n.Fragment,
      null,
      n.createElement(
        "div",
        {
          ref: i,
          style: {
            position: "absolute",
            top: 0,
            left: 50,
            width: "100%",
            height: "20px",
            display: "flex",
            justifyContent: "space-between",
            userSelect: "none",
          },
        },
        Array(a)
          .fill(1)
          .map(function (e, t) {
            return t % 10 == 0
              ? n.createElement(
                  "div",
                  {
                    key: t,
                    style: {
                      background: "rgb(204, 204, 204)",
                      width: "1px",
                      height: "12px",
                      position: "relative",
                      userSelect: "none",
                    },
                  },
                  n.createElement(
                    "div",
                    {
                      style: {
                        position: "absolute",
                        top: "20px",
                        fontSize: "10px",
                        left: "-2px",
                        userSelect: "none",
                      },
                    },
                    t
                  )
                )
              : n.createElement("div", {
                  key: t,
                  style: {
                    background: "rgb(204, 204, 204)",
                    width: "1px",
                    height: "6px",
                  },
                });
          })
      ),
      n.createElement(
        "div",
        {
          ref: o,
          style: {
            position: "absolute",
            top: 50,
            left: 0,
            width: "20px",
            height: "100%",
            display: "flex",
            justifyContent: "space-between",
            flexDirection: "column",
            userSelect: "none",
          },
        },
        Array(l)
          .fill(1)
          .map(function (e, t) {
            return t % 10 == 0
              ? n.createElement(
                  "div",
                  {
                    key: t,
                    style: {
                      background: "rgb(204, 204, 204)",
                      width: "12px",
                      height: "1px",
                      position: "relative",
                      userSelect: "none",
                    },
                  },
                  n.createElement(
                    "div",
                    {
                      style: {
                        position: "absolute",
                        left: "20px",
                        fontSize: "10px",
                        top: "-2px",
                        userSelect: "none",
                      },
                    },
                    t
                  )
                )
              : n.createElement("div", {
                  key: t,
                  style: {
                    background: "rgb(204, 204, 204)",
                    width: "6px",
                    height: "1px",
                    userSelect: "none",
                  },
                });
          })
      )
    )
  );
}
var _t = ["children", "style", "classNames", "config"],
  Ot = { labelCol: { span: 12 }, wrapperCol: { span: 12 } };
function At(e) {
  var i = S.useForm()[0],
    o = t.useState(O(e.config.marklineConfig.borderColor)),
    r = o[0],
    a = o[1];
  return n.createElement(
    C,
    {
      width: 800,
      visible: e.visible,
      okText: Ze("yes", "确定", e.config),
      cancelText: Ze("no", "取消", e.config),
      title: Ze("system.setting", "系统设置", e.config),
      onCancel: function () {
        return e.onCancel();
      },
      onOk: function () {
        var t = i.getFieldsValue(),
          n = t.min,
          o = t.max,
          a = t.borderStyle,
          c = t.containerOverFlow;
        if (o < n)
          e.message.error(Ze("error.minmax", Qe["error.minmax"], e.config));
        else {
          var s = e.config.scaleState.value;
          (s < n || s > o) && (e.config.scaleState.value = n),
            (e.config.marklineConfig.borderColor =
              "rgba(" + r.r + ", " + r.g + ", " + r.b + ", " + r.a + ")"),
            (e.config.marklineConfig.borderStyle = a),
            (e.config.containerOverFlow = c),
            e.onOk(t),
            e.config.containerForceUpdate();
        }
      },
    },
    n.createElement(
      S,
      Object.assign({}, Ot, {
        initialValues: {
          absorb: e.config.marklineConfig.isAbsorb,
          indent: e.config.marklineConfig.indent,
          min: e.config.scaleState.minValue,
          max: e.config.scaleState.maxValue,
          autofocus: e.config.timelineConfig.autoFocus,
          borderStyle: e.config.marklineConfig.borderStyle,
          containerOverFlow: e.config.containerOverFlow,
        },
        form: i,
      }),
      n.createElement(
        S.Item,
        {
          name: "absorb",
          label: Ze("settings.openabsorb", Qe["settings.openabsorb"], e.config),
        },
        n.createElement(
          D.Group,
          null,
          n.createElement(D, { value: !0 }, Ze("on", Qe.on, e.config)),
          n.createElement(D, { value: !1 }, Ze("off", Qe.off, e.config))
        )
      ),
      n.createElement(
        S.Item,
        {
          name: "indent",
          label: Ze(
            "settings.absorbindent",
            Qe["settings.absorbindent"],
            e.config
          ),
        },
        n.createElement(y, { min: 0.1 })
      ),
      n.createElement(
        S.Item,
        {
          label: Ze(
            "settings.marklineColor",
            Qe["settings.marklineColor"],
            e.config
          ),
        },
        n.createElement(kt, {
          initColor: O(e.config.marklineConfig.borderColor),
          onChange: function (e) {
            a(e);
          },
        })
      ),
      n.createElement(
        S.Item,
        {
          name: "borderStyle",
          label: Ze(
            "settings.marklineStyle",
            Qe["settings.marklineStyle"],
            e.config
          ),
        },
        n.createElement(
          k,
          { style: { width: 88 } },
          n.createElement(k.Option, { value: "dotted" }, "dotted"),
          n.createElement(k.Option, { value: "solid" }, "solid"),
          n.createElement(k.Option, { value: "dashed" }, "dashed")
        )
      ),
      n.createElement(
        S.Item,
        {
          name: "min",
          label: Ze("settings.min", Qe["settings.min"], e.config),
        },
        n.createElement(y, { min: 0.1, step: 0.1 })
      ),
      n.createElement(
        S.Item,
        {
          name: "max",
          label: Ze("settings.max", Qe["settings.max"], e.config),
        },
        n.createElement(y, { min: 0.1, step: 0.1 })
      ),
      n.createElement(
        S.Item,
        {
          name: "autofocus",
          label: Ze("settings.autofocus", Qe["settings.autofocus"], e.config),
        },
        n.createElement(
          D.Group,
          null,
          n.createElement(D, { value: !0 }, Ze("on", Qe.on, e.config)),
          n.createElement(D, { value: !1 }, Ze("off", Qe.off, e.config))
        )
      ),
      n.createElement(
        S.Item,
        {
          name: "containerOverFlow",
          label: Ze(
            "settings.containerOverflow",
            Qe["settings.containerOverflow"],
            e.config
          ),
        },
        n.createElement(
          D.Group,
          null,
          n.createElement(D, { value: !0 }, Ze("on", Qe.on, e.config)),
          n.createElement(D, { value: !1 }, Ze("off", Qe.off, e.config))
        )
      )
    )
  );
}
var Xt,
  Tt = t.memo(At),
  jt = { labelCol: { span: 4 }, wrapperCol: { span: 20 } },
  Yt = L.Text,
  Pt =
    /[`~!@#-_$%^&*()+=|{}':;',\[\]<>/?~！@#￥%……&*（）——+|{}【】《》 ‘；：”“’。，、？]/g,
  Ut = (function () {
    function e(e, t, n, i) {
      void 0 === e && (e = {}),
        void 0 === t && (t = []),
        void 0 === n && (n = {}),
        void 0 === i && (i = []),
        (this.formMap = e),
        (this.listener = t),
        (this.eventMap = n),
        (this.containerConfig = i);
    }
    var t = e.prototype;
    return (
      (t.getMap = function () {
        return this.formMap;
      }),
      (t.getComp = function (e) {
        return this.formMap[e];
      }),
      (t.getConfig = function () {
        return this.containerConfig;
      }),
      (t.setConfig = function (e) {
        this.containerConfig = e;
      }),
      (t.register = function (e, t) {
        this.formMap[e] = t;
      }),
      (t.emit = function () {
        this.listener.forEach(function (e) {
          return e();
        });
      }),
      (t.on = function (e, t) {
        var n = this;
        return (
          this.eventMap[e] || (this.eventMap[e] = []),
          this.eventMap[e].push(t),
          function () {
            return n.eventMap[e].filter(function (e) {
              return e !== t;
            });
          }
        );
      }),
      e
    );
  })(),
  zt = (function () {
    function e(e) {
      void 0 === e && (e = {}),
        (this.initConfig = e),
        (this.asyncMap = {}),
        (this.configMap = {}),
        (this.funcitonMap = {}),
        (this.nameMap = {}),
        (this.componentIdMap = {}),
        this.init(e);
    }
    var t = e.prototype;
    return (
      (t.init = function (e) {
        this.reset(),
          (this.funcitonMap = Object.keys(e).reduce(function (t, n) {
            return (t[n] = e[n].fn), t;
          }, {})),
          (this.configMap = Object.keys(e).reduce(function (t, n) {
            return (t[n] = e[n].config), t;
          }, {})),
          (this.nameMap = Object.keys(e).reduce(function (t, n) {
            return (t[n] = e[n].name), t;
          }, {})),
          (this.componentIdMap = Object.keys(e).reduce(function (t, n) {
            var i = e[n].componentId;
            return t[i] ? t[i].add(n) : (t[i] = new Set([n])), t;
          }, {}));
      }),
      (t.reset = function () {
        (this.funcitonMap = {}),
          (this.configMap = {}),
          (this.nameMap = {}),
          (this.componentIdMap = {});
      }),
      (t.getFunctionMap = function () {
        return this.funcitonMap;
      }),
      (t.getConfigMap = function () {
        return this.configMap;
      }),
      (t.getNameMap = function () {
        return this.nameMap;
      }),
      (t.nameToKey = function (e) {
        for (
          var t, n = Object.keys(this.nameMap), i = n.length, o = 0;
          o < i;
          o++
        ) {
          var r = n[o];
          if (this.nameMap[r] === e) {
            t = r;
            break;
          }
        }
        return t;
      }),
      (t.register = function (e) {
        var t = this,
          n = e.id,
          i = e.config,
          o = e.name,
          r = e.componentId;
        return (
          (this.funcitonMap[n] = e.fn),
          (this.configMap[n] = i),
          (this.nameMap[n] = o),
          this.componentIdMap[r]
            ? this.componentIdMap[r].add(n)
            : (this.componentIdMap[r] = new Set([n])),
          this.asyncMap[n] && this.asyncMap[n](),
          function () {
            delete t.funcitonMap[n],
              delete t.configMap[n],
              delete t.nameMap[n],
              t.componentIdMap[r].delete(n);
          }
        );
      }),
      (t.syncFunction = function (e) {
        var t,
          n = this,
          i = R,
          o = [],
          r = e.getData(),
          a = r.modalMap;
        Object.keys(a).forEach(function (e) {
          a[e].forEach(function (e) {
            o.push(e.id);
          });
        }),
          r.block.forEach(function (e) {
            o.push(e.id);
          }),
          e.isEdit() &&
            r.origin &&
            (null == (t = r.origin) ||
              t.forEach(function (e) {
                o.push(e.id);
              }));
        var c = [];
        Object.keys(this.componentIdMap).forEach(function (e) {
          i.includes(e) || o.includes(e) || c.push(e);
        }),
          c.forEach(function (e) {
            n.componentIdMap[e].forEach(function (e) {
              delete n.funcitonMap[e],
                delete n.configMap[e],
                delete n.nameMap[e];
            }),
              delete n.componentIdMap[e];
          });
      }),
      (t.getFunction = function (e) {
        var t = this,
          n = this.funcitonMap[e];
        return n
          ? Promise.resolve(n)
          : new Promise(function (n) {
              console.warn("waiting the function now " + e + " "),
                (t.asyncMap[e] = function () {
                  delete t.asyncMap[e], n(t.getFunction(e));
                });
            });
      }),
      e
    );
  })(),
  qt = (function () {
    function e(e, t, n) {
      void 0 === e && (e = 1),
        void 0 === n && (n = {}),
        (this.available = e),
        (this.waiters = []),
        (this._continue = this._continue.bind(this)),
        (this.context = n),
        (this.config = t);
    }
    var t = e.prototype;
    return (
      (t.take = function (e, t, n, i) {
        this.available > 0
          ? (this.available--,
            e(this.context, this.leave.bind(this), this.config, t, n, i))
          : this.waiters.push({ fn: e, args: t, eventList: n, iname: i });
      }),
      (t.leave = function () {
        this.available++, this.waiters.length > 0 && this._continue();
      }),
      (t._continue = function () {
        if (this.available > 0) {
          this.available--;
          var e = this.waiters.shift();
          null != e &&
            e.fn &&
            e.fn(
              this.context,
              this.leave.bind(this),
              this.config,
              e.args,
              e.eventList,
              e.iname
            );
        }
      }),
      e
    );
  })(),
  Bt = (function () {
    function e(e, t) {
      void 0 === e && (e = {}),
        (this.eventMap = e),
        (this.functionCenter = new zt(t));
    }
    var t = e.prototype;
    return (
      (t.getFunctionCenter = function () {
        return this.functionCenter;
      }),
      (t.getEventMap = function () {
        return this.eventMap;
      }),
      (t.resetEventMap = function () {
        this.eventMap = {};
      }),
      (t.syncEventMap = function (e, t) {
        var n = this,
          i = t.isEdit();
        (this.eventMap = {}),
          i
            ? (e.origin &&
                e.origin.forEach(function (e) {
                  n.eventMap = Object.assign(n.eventMap, e.eventMap);
                }),
              Object.keys(e.modalMap).forEach(function (t) {
                e.modalMap[t].forEach(function (e) {
                  n.eventMap = Object.assign(n.eventMap, e.eventMap);
                });
              }),
              e.block.forEach(function (e) {
                n.eventMap = Object.assign(n.eventMap, e.eventMap);
              }))
            : (e.block.forEach(function (e) {
                n.eventMap = Object.assign(n.eventMap, e.eventMap);
              }),
              Object.keys(e.modalMap).forEach(function (t) {
                e.modalMap[t].forEach(function (e) {
                  n.eventMap = Object.assign(n.eventMap, e.eventMap);
                });
              }));
      }),
      (t.manualUpdateMap = function (e, t, n) {
        this.eventMap[e] ||
          (this.eventMap[e] = { arr: [], displayName: t, userSelect: [] }),
          n && this.eventMap[e].displayName
            ? (this.eventMap[e].arr = n)
            : n &&
              this.eventMap[e] &&
              (this.eventMap[e] = { displayName: t, arr: n, userSelect: [] });
      }),
      (t.runEventQueue = (function () {
        var e = W(
          He.mark(function e(t, n) {
            var i, o, r, a, c;
            return He.wrap(
              function (e) {
                for (;;)
                  switch ((e.prev = e.next)) {
                    case 0:
                      if ((i = this.eventMap[t])) {
                        e.next = 4;
                        break;
                      }
                      return (
                        console.error("未查询到该事件" + t), e.abrupt("return")
                      );
                    case 4:
                      if (((o = new qt(1, n)), !Array.isArray(i.arr))) {
                        e.next = 15;
                        break;
                      }
                      r = J(i.arr);
                    case 7:
                      if ((a = r()).done) {
                        e.next = 15;
                        break;
                      }
                      return (
                        (c = a.value),
                        (e.next = 11),
                        this.functionCenter.getFunction(c.name)
                      );
                    case 11:
                      o.take(e.sent, c.args, i, c);
                    case 13:
                      e.next = 7;
                      break;
                    case 15:
                    case "end":
                      return e.stop();
                  }
              },
              e,
              this
            );
          })
        );
        return function (t, n) {
          return e.apply(this, arguments);
        };
      })()),
      e
    );
  })(),
  Gt = (function () {
    function e(e) {
      void 0 === e && (e = {}), (this.dataMap = e), (this.asyncMap = {});
    }
    var t = e.prototype;
    return (
      (t.getDataMap = function () {
        return this.dataMap;
      }),
      (t.setToMap = function (e) {
        var t = this;
        (this.dataMap = Object.assign(this.dataMap, e)),
          Object.keys(e).forEach(function (e) {
            t.asyncMap[e] && (t.asyncMap[e](), delete t.asyncMap[e]);
          });
      }),
      (t.staticSetToMap = function (e, t) {
        (this.dataMap = e), (t.getStore().getData().dataSource = e);
      }),
      (t.initAddToDataMap = function (e) {
        this.dataMap = e.dataSource;
      }),
      (t.getValue = function (e) {
        var t = this,
          n = this.dataMap[e];
        return n
          ? Promise.resolve(n)
          : new Promise(function (n) {
              t.asyncMap[e] = function () {
                n(t.getValue(e));
              };
            });
      }),
      (t.get = function (e) {
        return this.dataMap[e];
      }),
      e
    );
  })(),
  Wt = new Map();
function Kt(e) {
  var i = t.useMemo(
      function () {
        var t = e.data.modalMap[e.name];
        if (t) {
          var n = _(t);
          return n.shift(), { block: n };
        }
        return { block: [] };
      },
      [e.data.modalMap, e.name]
    ),
    o = e.parentDom,
    r = e.rootDom,
    a = e.data.modalConfig[e.name],
    s = t.useMemo(
      function () {
        return function () {
          var e;
          o &&
            r &&
            (c.unmountComponentAtNode(o),
            r.removeChild(o),
            null == (e = r.parentElement) || e.removeChild(r));
        };
      },
      [o, r]
    );
  return (
    Wt.set(e.name, s),
    n.createElement(
      n.Fragment,
      null,
      n.createElement(
        "div",
        {
          className: "yh-container-modal",
          style: {
            height: "100%",
            width: "100%",
            position: "fixed",
            overflow: "hidden",
          },
        },
        i.block.map(function (t) {
          return n.createElement(Et, {
            key: t.id,
            config: e.config,
            data: t,
            context: "preview",
          });
        }),
        n.createElement("div", {
          onClick: function () {
            a || s();
          },
          style: {
            backgroundColor: "#716f6f9e",
            width: "100%",
            height: "100%",
          },
        })
      )
    )
  );
}
var Vt = { value: 0.8, maxValue: 1.3, minValue: 0.4 },
  Ht = function (e, t, n, i, o, r, a, c, s, l) {
    void 0 === r && (r = !0),
      void 0 === a && (a = !0),
      void 0 === c && (c = function () {}),
      void 0 === s && (s = function () {}),
      void 0 === l && (l = {}),
      (this.name = e),
      (this.display = t),
      (this.props = n),
      (this.initData = i),
      (this.render = o),
      (this.resize = r),
      (this.needPosition = a),
      (this.init = c),
      (this.destroy = s),
      (this.remoteConfig = l);
  },
  Jt = new Ht(
    "modalMask",
    "模态框遮罩",
    {},
    {
      props: {},
      position: "fixed",
      top: 0,
      left: 0,
      zIndex: 999,
      width: "100%",
      height: "100%",
      canDrag: !1,
    },
    function (e, t, i, o) {
      var r = i.getData().container;
      return n.createElement(
        "div",
        {
          style: {
            width: "preview" === t ? "100%" : r.width,
            height: "preview" === t ? "100%" : r.height,
            backgroundColor: "#716f6f9e",
            display: "flex",
            justifyContent: "center",
            alignItems: "center",
          },
        },
        "edit" === t &&
          n.createElement(a, {
            type: "primary",
            shape: "circle",
            title: "save",
            style: { position: "absolute", right: "10px", top: "10px" },
            icon: n.createElement(u.SaveOutlined, null),
            onClick: function () {
              o.getStore().closeModal();
            },
          })
      );
    },
    !0,
    !1
  ),
  Qt = {
    a: "a",
    A: "a",
    b: "b",
    B: "b",
    c: "c",
    C: "c",
    d: "d",
    D: "d",
    e: "e",
    E: "e",
    f: "f",
    F: "f",
    g: "g",
    G: "g",
    h: "h",
    H: "h",
    i: "i",
    I: "i",
    j: "j",
    J: "j",
    k: "k",
    K: "k",
    l: "l",
    L: "l",
    m: "m",
    M: "m",
    n: "n",
    N: "n",
    o: "o",
    O: "o",
    p: "p",
    P: "p",
    q: "q",
    Q: "q",
    r: "r",
    R: "r",
    s: "s",
    S: "s",
    t: "t",
    T: "t",
    u: "u",
    U: "u",
    v: "v",
    V: "v",
    w: "w",
    W: "w",
    x: "x",
    X: "x",
    y: "y",
    Y: "y",
    z: "z",
    Z: "z",
  },
  Zt = (function () {
    function e(e, t, n) {
      void 0 === t && (t = {}),
        (this.store = e),
        (this.commandMap = t),
        (this.config = n);
    }
    var t = e.prototype;
    return (
      (t.getList = function () {
        return this.commandMap;
      }),
      (t.register = function (e) {
        if ((e.init(), !this.commandMap[e.name])) {
          this.commandMap[e.name] = e;
          var t = this.registerKeyBoard(e),
            n = e.destroy;
          e.destroy = function () {
            t(), n();
          };
        }
      }),
      (t.registerKeyBoard = function (e) {
        var t = this;
        if (0 === e.keyboard.length) return function () {};
        var n = function (n) {
          if (
            document.activeElement === document.body ||
            n.target === document.body
          ) {
            var i = n.shiftKey,
              o = n.altKey,
              r = n.key,
              a = [];
            if (
              ((n.ctrlKey || n.metaKey) && a.push("Control"),
              i && a.push("Shift"),
              o && a.push("Alt"),
              "Control" !== r && "Shift" !== r && "Alt" !== r)
            ) {
              var c = (function (e) {
                return Qt[e];
              })(r);
              a.push(void 0 !== c ? c : r);
            }
            var s = a.join("+");
            e.keyboard === s &&
              (e.excute(t.store, t.config),
              n.stopPropagation(),
              n.preventDefault());
          }
        };
        return (
          window.addEventListener("keydown", n),
          function () {
            return window.removeEventListener("keydown", n);
          }
        );
      }),
      (t.unRegister = function (e) {
        if (this.commandMap[e]) {
          var t = this.commandMap[e];
          t.destroy(), delete this.commandMap[t.name];
        } else console.error(e + " commander not found");
      }),
      (t.exec = function (e, t) {
        this.commandMap[e]
          ? this.commandMap[e].excute(this.store, this.config, t)
          : console.error(e + " commander not found");
      }),
      e
    );
  })(),
  $t = { blocks: [] },
  en = (function () {
    function e(e, t, n, i) {
      void 0 === e && (e = {}),
        void 0 === t && (t = []),
        void 0 === n && (n = []),
        void 0 === i && (i = {}),
        (this.componentMap = e),
        (this.componentList = t),
        (this.listener = n),
        (this.eventMap = i);
    }
    var t = e.prototype;
    return (
      (t.getMap = function () {
        return this.componentMap;
      }),
      (t.getList = function () {
        return this.componentList;
      }),
      (t.getComp = function (e) {
        return this.componentMap[e];
      }),
      (t.subscribe = function (e) {
        var t = this;
        return (
          this.listener.push(e),
          function () {
            return t.listener.filter(function (t) {
              return t !== e;
            });
          }
        );
      }),
      (t.emit = function () {
        this.listener.forEach(function (e) {
          return e();
        });
      }),
      (t.on = function (e, t) {
        var n = this;
        return (
          this.eventMap[e] || (this.eventMap[e] = []),
          this.eventMap[e].push(t),
          function () {
            return n.eventMap[e].filter(function (e) {
              return e !== t;
            });
          }
        );
      }),
      (t.emitEvent = function (e) {
        this.eventMap[e] &&
          this.eventMap[e].forEach(function (e) {
            return e();
          });
      }),
      (t.register = function (e) {
        this.componentMap[e.name] ||
          (e instanceof Ht || console.error(e, "may be a problem in register"),
          (this.componentMap[e.name] = e),
          this.componentList.push(e),
          this.emit(),
          e.init());
      }),
      (t.unRegister = function (e) {
        if (this.componentMap[e]) {
          var t = this.componentMap[e];
          t.destroy(),
            this.emit(),
            (this.componentList = this.componentList.filter(function (e) {
              return e !== t;
            })),
            delete this.componentMap[t.name];
        } else console.error(e + " component not found");
      }),
      e
    );
  })(),
  tn = {
    container: { width: 375, height: 667, isMinwx: !0 },
    block: [],
    modalMap: {},
    dataSource: {},
    globalState: {},
    modalConfig: {},
    origin: null,
    modalEditName: "",
  },
  nn = (function () {
    function e(e, t, n, i) {
      void 0 === e && (e = [tn]),
        void 0 === t && (t = []),
        void 0 === n && (n = 0),
        void 0 === i && (i = function () {}),
        (this.storeDataList = e),
        (this.listeners = t),
        (this.current = n),
        (this.forceupdate = i);
    }
    var t = e.prototype;
    return (
      (t.getData = function () {
        return this.storeDataList[this.current];
      }),
      (t.getStoreList = function () {
        return this.storeDataList;
      }),
      (t.getListeners = function () {
        return this.listeners;
      }),
      (t.getIndex = function () {
        return this.current;
      }),
      (t.getOriginBlock = function () {
        return this.isEdit() ? this.getData().origin : this.getData().block;
      }),
      (t.changeModaltoNormal = function (e) {
        var t;
        if ("" !== e.modalEditName) {
          var n = e.origin || [];
          return (
            (e.modalMap = K(
              {},
              e.modalMap,
              (((t = {})[e.modalEditName] = e.block), t)
            )),
            (e.block = n),
            (e.modalEditName = ""),
            (e.origin = null),
            {}
          );
        }
      }),
      (t.changeNormalToModal = function (e, t) {
        if ("" !== e.modalEditName) return { success: !1, sign: 0 };
        if (!this.isInModalMap(t)) return { success: !1, sign: 1, param: t };
        var n = e.block || [];
        return (
          (e.block = e.modalMap[t]),
          (e.modalEditName = t),
          (e.origin = n),
          { success: !0, sign: -1 }
        );
      }),
      (t.newModaltoNormal = function (e, t) {
        var n;
        if ("" === e.modalEditName) {
          var i = e.block || [],
            o = [
              {
                id: A("modal-mask"),
                name: "modalMask",
                top: 0,
                left: 0,
                width: "100%",
                height: "100%",
                zIndex: 0,
                props: {},
                resize: !0,
                focus: !1,
                canSee: !0,
                position: "absolute",
                display: "block",
                syncList: [],
                canDrag: !1,
                eventMap: {},
                functionList: [],
                animate: [],
                fixed: !0,
                rotate: { value: 0, canRotate: !1 },
              },
            ];
          (e.modalMap = K({}, e.modalMap, (((n = {})[t] = o), n))),
            (e.block = o),
            (e.modalEditName = t),
            (e.origin = i);
        }
      }),
      (t.isEdit = function () {
        return "" !== this.getData().modalEditName;
      }),
      (t.isInModalMap = function (e) {
        return !!Object.keys(this.getData().modalMap).includes(e);
      }),
      (t.newModalMap = function (e) {
        if (this.isEdit()) return { succeess: !1, sign: 0 };
        if (this.isInModalMap(e)) return { succeess: !1, sign: 1, param: e };
        var t = r(this.getData());
        return (
          this.newModaltoNormal(t, e),
          this.setData(t),
          { succeess: !0, sign: -1 }
        );
      }),
      (t.closeModal = function () {
        if (!this.isEdit()) return { success: !1, sign: 0 };
        var e = r(this.getData());
        return (
          this.changeModaltoNormal(e), this.setData(e), { success: !0, sign: 0 }
        );
      }),
      (t.removeModal = function (e) {
        if (this.isEdit()) return { success: !1, sign: 0 };
        if (!this.isInModalMap(e)) return { success: !1, sign: 1, param: e };
        var t = r(this.getData());
        return delete t.modalMap[e], this.setData(t), { success: !0, sign: -1 };
      }),
      (t.resetToInitData = function (e, t) {
        void 0 === t && (t = !1), (this.storeDataList = e), (this.current = 0);
        var n = this.getData();
        "" !== n.modalEditName && t && this.changeModaltoNormal(n), this.emit();
      }),
      (t.resetToCustomData = function (e, t, n) {
        void 0 === n && (n = !1), (this.storeDataList = e), (this.current = t);
        var i = this.getData();
        "" !== i.modalEditName && n && this.changeModaltoNormal(i), this.emit();
      }),
      (t.resetListeners = function () {
        this.listeners = [];
      }),
      (t.replaceList = function (e) {
        this.storeDataList = e;
      }),
      (t.setForceUpdate = function (e) {
        this.forceupdate = e;
      }),
      (t.forceUpdate = function () {
        this.forceupdate();
      }),
      (t.setIndex = function (e) {
        this.current = e;
      }),
      (t.redo = function () {
        this.current + 1 < this.storeDataList.length &&
          ((this.current = this.current + 1), this.emit());
      }),
      (t.undo = function () {
        this.current > 0 && ((this.current = this.current - 1), this.emit());
      }),
      (t.cleanRedundant = function (e) {
        this.storeDataList = this.storeDataList.slice(0, e + 1);
      }),
      (t.setData = function (e) {
        var t = !0;
        this.current + 1 !== this.storeDataList.length &&
          (this.cleanRedundant(this.current), (t = !1)),
          (this.current = this.current + 1),
          (this.storeDataList[this.current] = e),
          t &&
            this.current + 1 !== this.storeDataList.length &&
            (this.storeDataList.length = this.current + 1),
          this.emit();
      }),
      (t.cleanLast = function () {
        this.current <= 1 ||
          (this.storeDataList.splice(this.current - 1, 1),
          (this.current = this.current - 1));
      }),
      (t.emit = function () {
        var e = this;
        this.listeners.forEach(function (t) {
          t(e.getData());
        });
      }),
      (t.subscribe = function (e) {
        var t = this;
        return (
          this.listeners.push(e),
          function () {
            return (t.listeners = t.listeners.filter(function (t) {
              return t !== e;
            }));
          }
        );
      }),
      e
    );
  })(),
  on = (function () {
    function e(e) {
      void 0 === e && (e = []), (this.customAnimateName = e);
    }
    var t = e.prototype;
    return (
      (t.getCustomAnimateName = function () {
        return this.customAnimateName;
      }),
      (t.searchSheet = function () {
        var e = null;
        return (
          Array.from(document.styleSheets).forEach(function (t) {
            var n = null == t ? void 0 : t.ownerNode;
            "dooringx_dynamic_style" === (null == n ? void 0 : n.id) && (e = t);
          }),
          e
        );
      }),
      (t.getStyleSheets = function () {
        if (!this.searchSheet()) {
          var e = document.createElement("style");
          (e.id = "dooringx_dynamic_style"),
            e.appendChild(document.createTextNode("")),
            document.head.appendChild(e);
        }
        return this.searchSheet();
      }),
      (t.inserKeyframeAnimate = function (e) {
        var t = this.getStyleSheets();
        t && t.insertRule(e, t.cssRules.length);
      }),
      (t.deleteKeyFrameAnimate = function (e) {
        var t = this.getStyleSheets();
        if (t) {
          for (var n = t.cssRules.length, i = null, o = 0; o < n; o++) {
            var r = t.cssRules[o],
              a = null == r ? void 0 : r.name;
            a && a === e && (i = o);
          }
          null !== i && t.deleteRule(i);
        }
      }),
      (t.addCustomAnimate = function (e) {
        void 0 === e && (e = []),
          (this.customAnimateName = [].concat(this.customAnimateName, e));
      }),
      (t.deleteCustomAnimate = function (e) {
        this.customAnimateName = this.customAnimateName.filter(function (t) {
          return t.animateName !== e;
        });
      }),
      (t.fromArrInsertKeyFrame = function (e) {
        var t = this;
        void 0 === e && (e = this.customAnimateName),
          e.forEach(function (e) {
            t.inserKeyframeAnimate(e.keyframe);
          });
      }),
      (t.syncToStore = function (e) {
        var t = e.getStore(),
          n = _(t.getData());
        (n.globalState.customAnimate = [].concat(this.customAnimateName)),
          t.setData(n);
      }),
      (t.syncStoreToConfig = function (e) {
        var t,
          n =
            null == (t = e.getStore().getData().globalState)
              ? void 0
              : t.customAnimate;
        this.customAnimateName = [].concat(n);
      }),
      (t.addUserInputIntoCustom = function (e, t) {
        var n = e.keyframes.map(function (e) {
            return (
              e.percent +
              "% {\n            transform:translate(" +
              e.positionX +
              "px, " +
              e.positionY +
              "px) scale(" +
              (e.scale / 100).toFixed(2) +
              ") rotate(" +
              e.rotate +
              "deg);\n         }"
            );
          }),
          i =
            "@keyframes " +
            e.animateName +
            " {\n      " +
            n.join(" ") +
            "\n    }";
        this.addCustomAnimate([
          {
            displayName: e.displayName,
            keyframe: i,
            animateName: e.animateName,
          },
        ]),
          this.inserKeyframeAnimate(i),
          this.syncToStore(t);
      }),
      e
    );
  })(),
  rn = {
    container: { width: 375, height: 667, isMinwx: !0 },
    block: [],
    modalMap: {},
    dataSource: { defaultKey: "defaultValue" },
    globalState: {
      containerColor: "rgba(255,255,255,1)",
      title: "lowCode",
      description: "店铺模板",
      bodyColor: "rgba(255,255,255,1)",
      script: [],
      customAnimate: [],
      lineHeight: 1.575,
      fontSize: 14,
    },
    modalConfig: {},
    modalEditName: "",
    origin: null,
  },
  an = {
    initStoreData: [rn],
    leftAllRegistMap: [],
    leftRenderListCategory: [],
    rightGlobalCustom: null,
    rightRenderListCategory: [],
    initComponentCache: { modalMask: { component: Jt } },
    initFunctionMap: {
      open_modal: {
        fn: function (e, t, i, o) {
          !(function (e, t, i) {
            if ((Xt && (Xt = null), e)) {
              Xt ||
                (((Xt = document.createElement("div")).style.cssText =
                  "line-height:\n        1.5;text-align:\n        center;color: #333;\n        box-sizing: border-box;\n        margin: 0;\n        padding: 0;\n        list-style: none;\n        position: fixed;\n        z-index: 100000;\n        width: 100%;\n        height:100%;\n        top:0;\n        left: 0;"),
                Xt && document.body.appendChild(Xt));
              var o = document.createElement("div");
              Xt.appendChild(o),
                c.render(
                  n.createElement(Kt, {
                    name: e,
                    data: t,
                    config: i,
                    parentDom: o,
                    rootDom: Xt,
                  }),
                  o
                );
            }
          })(o._modal, i.getStore().getData(), i),
            t();
        },
        config: [
          {
            name: "弹窗名称",
            data: ["modal"],
            options: { receive: "_modal", multi: !1 },
          },
        ],
        name: "打开弹窗函数",
        componentId: "_inner",
      },
      close_modal: {
        fn: function (e, t, n, i) {
          var o = Wt.get(i._modal);
          o && o(), t();
        },
        config: [
          {
            name: "弹窗名称",
            data: ["modal"],
            options: { receive: "_modal", multi: !1 },
          },
        ],
        name: "关闭弹窗函数",
        componentId: "_inner",
      },
    },
    initDataCenterMap: {},
    initCommandModule: [],
    initFormComponents: {},
    containerIcon: n.createElement(u.VerticalAlignMiddleOutlined, null),
  };
function cn(e, t) {
  var n = {
    initStoreData: [rn],
    leftAllRegistMap: [],
    leftRenderListCategory: [],
    rightRenderListCategory: [],
    initComponentCache: {},
    initFunctionMap: {},
    initDataCenterMap: {},
    initCommandModule: [],
    rightGlobalCustom: null,
    initFormComponents: {},
    containerIcon: null,
  };
  return t
    ? ((n.initStoreData = t.initStoreData
        ? [].concat(t.initStoreData)
        : e.initStoreData
        ? [].concat(e.initStoreData)
        : [rn]),
      (n.containerIcon = t.containerIcon ? t.containerIcon : e.containerIcon),
      (n.rightGlobalCustom = t.rightGlobalCustom
        ? t.rightGlobalCustom
        : e.rightGlobalCustom),
      (n.leftAllRegistMap = t.leftAllRegistMap
        ? e.leftAllRegistMap
          ? [].concat(e.leftAllRegistMap, t.leftAllRegistMap)
          : [].concat(t.leftAllRegistMap)
        : e.leftAllRegistMap
        ? [].concat(e.leftAllRegistMap)
        : []),
      (n.leftRenderListCategory = t.leftRenderListCategory
        ? e.leftRenderListCategory
          ? [].concat(e.leftRenderListCategory, t.leftRenderListCategory)
          : [].concat(t.leftRenderListCategory)
        : [].concat(
            e.leftRenderListCategory
              ? e.leftRenderListCategory
              : an.leftRenderListCategory
          )),
      (n.rightRenderListCategory = t.rightRenderListCategory
        ? e.rightRenderListCategory
          ? [].concat(e.rightRenderListCategory, t.rightRenderListCategory)
          : [].concat(t.rightRenderListCategory)
        : [].concat(
            e.rightRenderListCategory
              ? e.rightRenderListCategory
              : an.rightRenderListCategory
          )),
      (n.initComponentCache = K(
        {},
        e.initComponentCache,
        t.initComponentCache
      )),
      (n.initFunctionMap = K({}, e.initFunctionMap, t.initFunctionMap)),
      (n.initFormComponents = K(
        {},
        e.initFormComponents,
        t.initFormComponents
      )),
      (n.initDataCenterMap = K({}, e.initDataCenterMap, t.initDataCenterMap)),
      (n.initCommandModule = t.initCommandModule
        ? e.initCommandModule
          ? [].concat(e.initCommandModule, t.initCommandModule)
          : [].concat(t.initCommandModule)
        : e.initCommandModule
        ? [].concat(e.initCommandModule)
        : []),
      n)
    : cn(n, e);
}
var sn = (function () {
  function e(e) {
    (this.store = new nn()),
      (this.componentRegister = new en()),
      (this.formRegister = new Ut()),
      (this.animateFactory = new on()),
      (this.componentCache = {}),
      (this.asyncComponentUrlMap = {}),
      (this.marklineConfig = ve),
      (this.contextMenuState = se),
      (this.scaleState = Vt),
      (this.focusState = $t),
      (this.collapsed = !1),
      (this.ticker = !0),
      (this.containerOverFlow = !0),
      (this.containerForceUpdate = function () {}),
      (this.timeline = !1),
      (this.timelineConfig = { autoFocus: !0, scrollDom: null }),
      (this.timelineNeedleConfig = {
        status: "start",
        runFunc: function () {},
        resetFunc: function () {},
        pauseFunc: function () {},
        setNeedle: function () {},
        current: 0,
        isRefresh: !0,
      }),
      (this.createdFn = []),
      (this.created = function () {}),
      (this.beforeOnMountedFn = []),
      (this.beforeOnMounted = function () {}),
      (this.onMountedFn = []),
      (this.onMounted = function () {}),
      (this.destroyedFn = []),
      (this.destroyed = function () {}),
      (this.blockForceUpdate = []),
      (this.waitAnimate = !1),
      (this.wrapperMoveState = _e),
      (this.iframeWrapperMoveState = Oe),
      (this.refreshIframe = function () {}),
      (this.sendParent = function (e) {
        window.parent.postMessage(e, "*");
      }),
      (this.iframeOrigin = ""),
      (this.iframeId = "yh-container-iframe"),
      (this.i18n = !0),
      (this.SCRIPTGLOBALNAME = "DOORINGXPLUGIN"),
      (this.scriptLoading = !1),
      (this.leftForceUpdate = function () {}),
      (this.customMap = {});
    var t = cn(an, e);
    (this.initConfig = t),
      (this.commanderRegister = new Zt(this.store, {}, this)),
      (this.eventCenter = new Bt({}, t.initFunctionMap)),
      (this.dataCenter = new Gt(t.initDataCenterMap)),
      this.init();
  }
  var t = e.prototype;
  return (
    (t.toRegist = function () {
      var e,
        t,
        n = this;
      (e = this.formRegister),
        (t = this.initConfig.initFormComponents),
        Object.keys(t).forEach(function (n) {
          e.register(n, t[n]);
        });
      var i = this.initConfig.initComponentCache;
      (this.componentCache = i),
        Object.values(i).forEach(function (e) {
          e.component && n.registComponent(e.component);
        }),
        this.initConfig.leftAllRegistMap.forEach(function (e) {
          e.urlFn && (n.asyncComponentUrlMap[e.component] = e.urlFn);
        }),
        this.store.getData().block.forEach(function (e) {
          n.asyncRegistComponent(e.name);
        }),
        (this.dataCenter = new Gt(this.initConfig.initDataCenterMap)),
        this.dataCenter.initAddToDataMap(this.store.getData()),
        (this.eventCenter = new Bt({}, this.initConfig.initFunctionMap)),
        this.eventCenter.syncEventMap(this.store.getData(), this.store);
    }),
    (t.init = function () {
      this.store.resetToInitData(_(this.initConfig.initStoreData), !0),
        this.toRegist();
    }),
    (t.getCollapse = function () {
      return this.collapsed;
    }),
    (t.getStoreJSON = function () {
      return JSON.stringify(this.store.getData());
    }),
    (t.parseStoreJson = function (e) {
      return JSON.parse(e);
    }),
    (t.resetData = function (e) {
      this.store.resetToInitData(e, !0),
        this.toRegist(),
        this.animateFactory.syncStoreToConfig(this);
    }),
    (t.getWrapperMove = function () {
      return {
        data: this.wrapperMoveState,
        iframe: this.iframeWrapperMoveState,
      };
    }),
    (t.getFocusState = function () {
      return this.focusState;
    }),
    (t.getScaleState = function () {
      return this.scaleState;
    }),
    (t.getDataCenter = function () {
      return this.dataCenter;
    }),
    (t.getEventCenter = function () {
      return this.eventCenter;
    }),
    (t.getAnimateFactory = function () {
      return this.animateFactory;
    }),
    (t.getConfig = function () {
      return this.initConfig;
    }),
    (t.getStore = function () {
      return this.store;
    }),
    (t.getComponentRegister = function () {
      return this.componentRegister;
    }),
    (t.getContextMenuState = function () {
      return this.contextMenuState;
    }),
    (t.getFormRegister = function () {
      return this.formRegister;
    }),
    (t.getCommanderRegister = function () {
      return this.commanderRegister;
    }),
    (t.getCurrentData = function () {
      return this.store.getData();
    }),
    (t.resetConfig = function (e) {
      var t = cn(an, e);
      (this.initConfig = t),
        this.init(),
        this.leftForceUpdate(),
        this.store.forceUpdate();
    }),
    (t.addLeftCategory = function (e) {
      var t = {};
      (t.leftRenderListCategory = e),
        (this.initConfig = cn(this.initConfig, t)),
        this.init(),
        this.leftForceUpdate(),
        this.store.forceUpdate();
    }),
    (t.addRightCategory = function (e) {
      var t = {};
      (t.rightRenderListCategory = e),
        (this.initConfig = cn(this.initConfig, t)),
        this.init(),
        this.leftForceUpdate(),
        this.store.forceUpdate();
    }),
    (t.addCoRegistMap = function (e) {
      var t = {};
      (t.leftAllRegistMap = [e]),
        (this.initConfig = cn(this.initConfig, t)),
        this.init(),
        this.leftForceUpdate(),
        this.store.forceUpdate();
    }),
    (t.setConfig = function (e) {
      (this.initConfig = cn(this.initConfig, e)),
        this.init(),
        this.leftForceUpdate(),
        this.store.forceUpdate();
    }),
    (t.registCommander = function (e) {
      this.commanderRegister.register(e);
    }),
    (t.getMarklineConfig = function () {
      return this.marklineConfig;
    }),
    (t.getComponentCache = function () {
      return this.componentCache;
    }),
    (t.registComponent = function (e) {
      this.componentRegister.register(e);
    }),
    (t.asyncRegistComponent = (function () {
      var e = W(
        He.mark(function e(t) {
          var n;
          return He.wrap(
            function (e) {
              for (;;)
                switch ((e.prev = e.next)) {
                  case 0:
                    if (
                      this.componentCache[t] ||
                      !this.asyncComponentUrlMap[t]
                    ) {
                      e.next = 8;
                      break;
                    }
                    return (e.next = 3), this.asyncComponentUrlMap[t]();
                  case 3:
                    this.componentRegister.register((n = e.sent.default)),
                      (this.componentCache[t] = { component: n }),
                      this.componentRegister.emitEvent(t);
                  case 8:
                  case "end":
                    return e.stop();
                }
            },
            e,
            this
          );
        })
      );
      return function (t) {
        return e.apply(this, arguments);
      };
    })()),
    (t.scriptRegistComponentSingle = function (e, t) {
      this.registComponent(e), this.addCoRegistMap(t);
    }),
    (t.scriptSingleLoad = function (e, t, n) {
      var i = this,
        o = this.store.getData(),
        r = o.globalState;
      if (r.script.includes(e)) console.error(e + "scripts have been loaded");
      else if (!this.scriptLoading) {
        this.scriptLoading = !0;
        var a = document.createElement("script");
        (a.src = e),
          (a.onload = function () {
            var a = window[i.SCRIPTGLOBALNAME];
            try {
              var c = t;
              (c.component = a.name),
                (c.displayName = a.display),
                i.scriptRegistComponentSingle(a, c);
            } catch (e) {
              console.error(e);
            }
            setTimeout(function () {
              (window[i.SCRIPTGLOBALNAME] = void 0),
                (r = i.store.getData().globalState).script.push(e),
                (o.globalState = r),
                i.store.resetToInitData([o], !0),
                i.store.forceUpdate(),
                (i.scriptLoading = !1),
                n && n();
            });
          }),
          document.body.appendChild(a);
      }
    }),
    e
  );
})();
function ln(e) {
  var i = t.useRef(null),
    o = t.useRef(null),
    r = t.useState(0),
    a = r[0],
    c = r[1],
    s = t.useState(0),
    l = s[0],
    u = s[1],
    f = e.config.getScaleState().value;
  return (
    t.useEffect(
      function () {
        var e = setTimeout(function () {
          if (i.current) {
            var e = i.current.getBoundingClientRect().width,
              t = Math.ceil(e / 10 / f);
            t < Math.pow(2, 32) - 1 && c(t);
          }
          if (o.current) {
            var n = o.current.getBoundingClientRect().height,
              r = Math.ceil(n / 10 / f);
            r < Math.pow(2, 32) - 1 && u(r);
          }
        }, 300);
        return function () {
          clearTimeout(e);
        };
      },
      [e.config, e.config.collapsed, f]
    ),
    n.createElement(
      n.Fragment,
      null,
      n.createElement(
        "div",
        {
          ref: i,
          style: {
            position: "absolute",
            top: 0,
            left: 50,
            width: "100%",
            height: "20px",
            display: "flex",
            justifyContent: "space-between",
            userSelect: "none",
          },
        },
        Array(a)
          .fill(1)
          .map(function (e, t) {
            return t % 10 == 0
              ? n.createElement(
                  "div",
                  {
                    key: t,
                    style: {
                      background: "rgb(204, 204, 204)",
                      width: "1px",
                      height: "12px",
                      position: "relative",
                      userSelect: "none",
                    },
                  },
                  n.createElement(
                    "div",
                    {
                      style: {
                        position: "absolute",
                        top: "20px",
                        fontSize: "10px",
                        left: "-2px",
                        userSelect: "none",
                      },
                    },
                    t
                  )
                )
              : n.createElement("div", {
                  key: t,
                  style: {
                    background: "rgb(204, 204, 204)",
                    width: "1px",
                    height: "6px",
                  },
                });
          })
      ),
      n.createElement(
        "div",
        {
          ref: o,
          style: {
            position: "absolute",
            top: 50,
            left: 0,
            width: "20px",
            height: "100%",
            display: "flex",
            justifyContent: "space-between",
            flexDirection: "column",
            userSelect: "none",
          },
        },
        Array(l)
          .fill(1)
          .map(function (e, t) {
            return t % 10 == 0
              ? n.createElement(
                  "div",
                  {
                    key: t,
                    style: {
                      background: "rgb(204, 204, 204)",
                      width: "12px",
                      height: "1px",
                      position: "relative",
                      userSelect: "none",
                    },
                  },
                  n.createElement(
                    "div",
                    {
                      style: {
                        position: "absolute",
                        left: "20px",
                        fontSize: "10px",
                        top: "-2px",
                        userSelect: "none",
                      },
                    },
                    t
                  )
                )
              : n.createElement("div", {
                  key: t,
                  style: {
                    background: "rgb(204, 204, 204)",
                    width: "6px",
                    height: "1px",
                    userSelect: "none",
                  },
                });
          })
      )
    )
  );
}
var un = ["children", "style", "classNames", "config", "extra"];
(exports.CommanderItemFactory = function (e, t, n, i, o, r) {
  void 0 === o && (o = function () {}),
    void 0 === r && (r = function () {}),
    (this.name = e),
    (this.keyboard = t),
    (this.excute = n),
    (this.display = i),
    (this.init = o),
    (this.destroy = r);
}),
  (exports.ComponentItemFactory = Ht),
  (exports.Container = Ct),
  (exports.ContainerWrapper = function (e) {
    var i = e.children,
      o = e.style,
      r = e.classNames,
      a = e.config,
      c = V(e, _t),
      s = t.useRef(null),
      l = e.config.ticker;
    return n.createElement(
      "div",
      Object.assign(
        {
          className: "ant-menu " + (r || "") + " " + Z.yh_container_wrapper,
          ref: s,
          style: K(
            {
              backgroundColor: "#f0f0f0",
              height: "100%",
              display: "flex",
              justifyContent: "center",
              alignItems: "center",
              flex: 1,
              position: "relative",
              overflow: "hidden",
              userSelect: "none",
            },
            o
          ),
        },
        (function (e, t) {
          var n = t.getScaleState().value,
            i = t.getStore();
          return {
            onMouseDown: function (t) {
              se.unmountContextMenu(),
                t.target !== e.current ||
                  ((_e.isDrag = !0),
                  (_e.startX = t.clientX),
                  (_e.startY = t.clientY),
                  e.current &&
                    ((e.current.style.cursor = "grab"), (_e.ref = e)));
            },
            onMouseMove: function (e) {
              if (_e.isDrag) {
                var o = e.clientY - _e.startY;
                (_e.needX = _e.needX + (e.clientX - _e.startX) / n),
                  (_e.needY = _e.needY + o / n),
                  (_e.startX = e.clientX),
                  (_e.startY = e.clientY),
                  i.forceUpdate();
              }
              Fe(e, t);
            },
          };
        })(s, e.config),
        (function (e) {
          var t = e.getStore(),
            n = e.getScaleState();
          return {
            onWheel: function (i) {
              document.querySelector(".ant-modal-mask") ||
                (i.deltaY > 0
                  ? (It(),
                    n.value > n.minValue &&
                      ((n.value = n.value - 0.1),
                      t.forceUpdate(),
                      e.refreshIframe()))
                  : (It(),
                    n.value < n.maxValue &&
                      ((n.value = n.value + 0.1),
                      t.forceUpdate(),
                      e.refreshIframe())));
            },
          };
        })(e.config),
        c
      ),
      a.timeline && n.createElement(ut, { config: a }),
      i,
      l && n.createElement(Rt, { config: e.config })
    );
  }),
  (exports.Control = function (e) {
    var o = e.style,
      c = t.useState(!1),
      s = c[0],
      l = c[1],
      d = t.useState(!1),
      m = d[0],
      g = d[1],
      h = S.useForm()[0],
      v = t.useState(!1),
      y = v[0],
      x = v[1],
      b = i.useMessage(),
      w = b[0],
      M = b[1],
      k = t.useState({ x: 0, y: 0 }),
      D = k[0],
      N = k[1];
    return n.createElement(
      n.Fragment,
      null,
      n.createElement(
        "div",
        {
          className: "ant-menu",
          onMouseUp: Ne,
          style: K(
            {
              display: "flex",
              flexDirection: "column",
              justifyContent: "center",
              alignItems: "center",
              transform: "translate(" + D.x + "px," + D.y + "px)",
            },
            o
          ),
        },
        M,
        n.createElement(a, {
          onMouseDown: function (e) {
            (De.startX = e.clientX),
              (De.startY = e.clientY),
              (De.fn = N),
              (De.isMove = !0);
          },
          type: "text",
          style: { cursor: "move" },
          icon: n.createElement(u.UnorderedListOutlined, null),
        }),
        n.createElement(a, {
          icon: n.createElement(u.LayoutOutlined, null),
          onClick: function () {
            (e.config.ticker = !e.config.ticker),
              e.config.getStore().forceUpdate();
          },
        }),
        n.createElement(a, {
          icon: n.createElement(u.SyncOutlined, null),
          onClick: function () {
            (_e.needX = 0), (_e.needY = 0), e.config.getStore().forceUpdate();
          },
        }),
        n.createElement(a, {
          icon: n.createElement(u.SettingOutlined, null),
          onClick: function () {
            x(!0);
          },
        })
      ),
      n.createElement(
        C,
        {
          title: Ze("modal.control", "弹窗配置", e.config),
          visible: m,
          onOk: function () {
            return g(!1);
          },
          onCancel: function () {
            return g(!1);
          },
          footer: null,
        },
        n.createElement(
          E,
          null,
          e.config.getStore().isEdit() &&
            n.createElement(
              "div",
              null,
              Ze("modal.popup.exit", "请退出编辑弹窗后再打开该配置", e.config)
            ),
          !e.config.getStore().isEdit() &&
            Object.keys(e.config.getStore().getData().modalMap).map(function (
              t
            ) {
              return n.createElement(
                E.Item,
                {
                  key: t,
                  actions: [
                    n.createElement(
                      f,
                      {
                        title: Ze(
                          "modal.popup.edit",
                          "是否切换至该弹窗并进行编辑?",
                          e.config
                        ),
                        onConfirm: function () {
                          var n = e.config.getStore(),
                            i = r(n.getData()),
                            o = n.changeNormalToModal(i, t);
                          o.success || 0 !== o.sign
                            ? o.success || 1 !== o.sign
                              ? (g(!1), n.setData(i))
                              : w.error(
                                  Ze(
                                    "modal.popup.notfond",
                                    "未找到该弹窗 " + o.param,
                                    e.config,
                                    { name: o.param },
                                    "未找到该弹窗 {name}"
                                  )
                                )
                            : w.error(
                                Ze(
                                  "modal.popup.save",
                                  "请保存弹窗后编辑其他弹窗",
                                  e.config
                                )
                              );
                        },
                        okText: Ze("yes", "确定", e.config),
                        cancelText: Ze("no", "取消", e.config),
                      },
                      n.createElement(
                        a,
                        { type: "link" },
                        Ze("edit", "编辑", e.config)
                      )
                    ),
                    n.createElement(
                      f,
                      {
                        title: "您确定要删除这个弹窗吗?",
                        onConfirm: function () {
                          var n = e.config.getStore().removeModal(t);
                          n.success ||
                            0 !== n.sign ||
                            w.error(
                              Ze(
                                "modal.popup.save",
                                "请保存弹窗后编辑其他弹窗",
                                e.config
                              )
                            ),
                            n.success ||
                              1 !== n.sign ||
                              w.error(
                                Ze(
                                  "modal.popup.notfond",
                                  "未找到该弹窗 " + n.param,
                                  e.config,
                                  { name: n.param },
                                  "未找到该弹窗 {name}"
                                )
                              ),
                            g(!1);
                        },
                        okText: Ze("yes", "确定", e.config),
                        cancelText: Ze("no", "取消", e.config),
                      },
                      n.createElement(
                        a,
                        { type: "link" },
                        Ze("control.delete", "删除", e.config)
                      )
                    ),
                  ],
                },
                t
              );
            }),
          !e.config.getStore().isEdit() &&
            0 === Object.keys(e.config.getStore().getData().modalMap).length &&
            n.createElement(
              "div",
              { style: { textAlign: "center" } },
              Ze("modal.popup.nomodal", "暂时没有弹窗", e.config)
            )
        )
      ),
      n.createElement(
        C,
        {
          okText: Ze("yes", "确定", e.config),
          cancelText: Ze("no", "取消", e.config),
          onOk: function () {
            h.validateFields()
              .then(function (t) {
                h.resetFields();
                var n = t.modalName,
                  i = e.config.getStore().newModalMap(n);
                i.succeess ||
                  0 !== i.sign ||
                  w.error(
                    Ze("modal.popup.save", "请保存弹窗后编辑其他弹窗", e.config)
                  ),
                  i.succeess ||
                    1 !== i.sign ||
                    w.error(
                      Ze(
                        "modal.popup.repeat",
                        "已有重名弹窗 " + i.param,
                        e.config,
                        { name: i.param },
                        "已有重名弹窗 {name}"
                      )
                    ),
                  l(!1);
              })
              .catch(function (e) {
                console.log("Validate Failed:", e);
              });
          },
          title: Ze("modal.new", "新增弹窗", e.config),
          onCancel: function () {
            return l(!1);
          },
          visible: s,
        },
        n.createElement(
          S,
          { layout: "vertical", name: "basic", form: h },
          n.createElement(
            S.Item,
            {
              label: Ze("modal.name", "弹窗名称", e.config),
              name: "modalName",
              rules: [
                {
                  required: !0,
                  message: Ze("modal.popup.name", "请输入弹窗名称!", e.config),
                },
              ],
            },
            n.createElement(p, null)
          )
        )
      ),
      n.createElement(Tt, {
        config: e.config,
        visible: y,
        onOk: function (t) {
          (e.config.marklineConfig.isAbsorb = t.absorb),
            (e.config.marklineConfig.indent = t.indent),
            (e.config.scaleState.minValue = t.min),
            (e.config.scaleState.maxValue = t.max),
            (e.config.timelineConfig.autoFocus = t.autofocus),
            x(!1);
        },
        onCancel: function () {
          return x(!1);
        },
        message: w,
      })
    );
  }),
  (exports.IframeContainer = function (e) {
    var i = e.editContainerStyle,
      o = e.previewContainerStyle,
      r = t.useState({
        store: rn,
        scaleState: { value: 0, maxValue: 0, minValue: 0 },
        isEdit: !1,
        wrapperState: e.config.getWrapperMove(),
        origin: null,
      }),
      a = r[0],
      c = r[1],
      s = a.store,
      l = a.scaleState,
      u = a.isEdit,
      f = function () {
        return u ? "rgba(255,255,255,1)" : s.globalState.containerColor;
      },
      d = t.useMemo(
        function () {
          return "edit" === e.context
            ? "scale(" +
                l.value +
                ") translate(" +
                Oe.needX +
                "px, " +
                Oe.needY +
                "px)"
            : void 0;
        },
        [e.context, l.value]
      );
    return (
      t.useEffect(
        function () {
          var t = function (t) {
            if ("object" == typeof t.data && t.data.store) {
              var n = t.data;
              c(n),
                e.config.resetData([n.store]),
                (e.config.scaleState = n.scaleState);
            }
          };
          return (
            window.addEventListener("message", t),
            window.parent.postMessage("ready", "*"),
            function () {
              window.removeEventListener("message", t);
            }
          );
        },
        [e.config]
      ),
      n.createElement(
        n.Fragment,
        null,
        "edit" === e.context &&
          n.createElement(
            n.Fragment,
            null,
            n.createElement(
              "div",
              Object.assign(
                {
                  style: {
                    display: "flex",
                    transform: "scale(" + l.value + ")",
                    transformOrigin: "left top",
                    position: "absolute",
                  },
                },
                Ft(e.config, l)
              ),
              n.createElement(
                "div",
                Object.assign(
                  {
                    id: "yh-container",
                    className: Z.yh_container,
                    style: K(
                      {
                        height: s.container.height + "px",
                        width: s.container.width + "px",
                        backgroundColor: f(),
                        position: "relative",
                        overflow: "hidden",
                      },
                      i
                    ),
                  },
                  "edit" === e.context ? he(e.config) : null,
                  "edit" === e.context ? ft(e.config) : null,
                  "edit" === e.context ? fe(e.config) : null
                ),
                s.block.map(function (t) {
                  return n.createElement(Et, {
                    config: e.config,
                    key: t.id,
                    data: t,
                    context: e.context,
                  });
                })
              )
            )
          ),
        "preview" === e.context &&
          n.createElement(
            "div",
            {
              id: "yh-container-preview",
              className: Z.yh_container_preview,
              style: K(
                {
                  height: Mt(s.container.height) + "px",
                  width: "100%",
                  position: "relative",
                  overflow: "hidden",
                  backgroundColor: f(),
                  transform: d,
                },
                o
              ),
            },
            s.block.map(function (t) {
              return n.createElement(Et, {
                key: t.id,
                config: e.config,
                data: t,
                context: e.context,
              });
            })
          )
      )
    );
  }),
  (exports.IframeContainerWrapper = function (e) {
    var i = e.children,
      o = e.style,
      r = e.classNames,
      a = e.config,
      c = e.extra,
      s = V(e, un),
      l = t.useRef(null),
      u = e.config.ticker,
      f = a.getWrapperMove().iframe,
      d = a.getScaleState(),
      m = e.config.getStore().getData();
    return n.createElement(
      "div",
      Object.assign(
        {
          className: "ant-menu " + (r || ""),
          ref: l,
          style: K(
            {
              backgroundColor: "#f0f0f0",
              height: "100%",
              display: "flex",
              justifyContent: "center",
              alignItems: "center",
              flex: 1,
              flexDirection: "column",
              position: "relative",
              overflow: "hidden",
              userSelect: "none",
            },
            o
          ),
        },
        (function (e, t) {
          var n = t.getStore();
          return {
            onMouseDown: function (t) {
              se.unmountContextMenu(),
                t.target !== e.current ||
                  ((Oe.isDrag = !0),
                  (Oe.startX = t.clientX),
                  (Oe.startY = t.clientY),
                  e.current &&
                    ((e.current.style.cursor = "grab"), (Ae.ref = e)));
            },
            onMouseMove: function (e) {
              if (Oe.isDrag) {
                var i = e.clientY - Oe.startY;
                (Oe.needX = Oe.needX + (e.clientX - Oe.startX)),
                  (Oe.needY = Oe.needY + i),
                  (Oe.startX = e.clientX),
                  (Oe.startY = e.clientY),
                  n.forceUpdate();
              }
              Fe(e, t);
            },
          };
        })(l, e.config),
        Ft(e.config, d),
        s
      ),
      a.timeline && n.createElement(ut, { config: a }),
      n.createElement(
        "div",
        {
          style: {
            position: "absolute",
            transform: "translate(" + f.needX + "px, " + f.needY + "px)",
            width: m.container.width * d.value,
            height: m.container.height * d.value,
          },
        },
        i
      ),
      c && c,
      u && n.createElement(ln, { config: e.config })
    );
  }),
  (exports.IframeTarget = function (e) {
    var t = e.config.getScaleState(),
      i = e.config.getStore().getData();
    return n.createElement(
      "div",
      {
        style: {
          width: i.container.width * t.value,
          height: i.container.height * t.value + 1,
          position: "relative",
        },
      },
      n.createElement(
        "div",
        Object.assign({}, he(e.config), ft(e.config), fe(e.config), {
          style: {
            width: i.container.width * t.value,
            height: i.container.height * t.value,
            position: "absolute",
          },
        }),
        n.createElement(
          "div",
          {
            id: "yh-container-iframe-mask",
            style: {
              display: "flex",
              transform: "scale(" + t.value + ")",
              transformOrigin: "left top",
              position: "absolute",
              width: i.container.width,
              height: i.container.height,
            },
          },
          i.block.map(function (t) {
            return n.createElement(Et, {
              config: e.config,
              key: t.id,
              data: t,
              context: "edit",
              iframe: !0,
            });
          }),
          n.createElement(xt, { config: e.config, iframe: !0 })
        )
      ),
      n.createElement(
        "iframe",
        Object.assign(
          {
            title: "editor",
            id: "yh-container-iframe",
            scrolling: "no",
            style: {
              width: i.container.width * t.value,
              height: i.container.height * t.value,
              border: "none",
              userSelect: "none",
            },
          },
          e.iframeProps
        )
      ),
      n.createElement(
        "div",
        {
          style: {
            height: "50px",
            display: "flex",
            justifyContent: "center",
            alignItems: "center",
            transform: "scale(" + t.value + ")",
            width: "100%",
            transformOrigin: "top",
          },
        },
        n.createElement(
          "div",
          {
            style: { fontSize: "20px", cursor: "s-resize" },
            onMouseDown: function (t) {
              return Le(t, e.config);
            },
          },
          e.config.getConfig().containerIcon
        )
      )
    );
  }),
  (exports.LeftConfig = function (e) {
    var i = t.useState("0"),
      o = i[0],
      r = i[1],
      a = t.useState(null),
      c = a[0],
      s = a[1],
      l = t.useState(0),
      f = l[0],
      d = l[1];
    t.useMemo(
      function () {
        e.config.leftForceUpdate = function () {
          d(function (e) {
            return e + 1;
          });
        };
      },
      [e.config]
    );
    var m = t.useMemo(
        function () {
          return e.config.getConfig().leftRenderListCategory;
        },
        [e.config, f]
      ),
      h = t.useState(""),
      v = h[0],
      y = h[1];
    t.useEffect(
      function () {
        var t,
          i,
          r = [],
          a = null == (t = m[parseInt(o, 10)]) ? void 0 : t.type;
        if (null == (i = m[parseInt(o, 10)]) ? void 0 : i.custom) {
          var c,
            l = null == (c = m[parseInt(o, 10)]) ? void 0 : c.customRender;
          s(n.createElement("div", { className: Z.leftco }, l && l(e.config)));
        } else
          (r = e.config.getConfig().leftAllRegistMap.filter(function (e) {
            return e.type === a;
          })).forEach(function (t) {
            return e.config.asyncRegistComponent(t.component);
          }),
            s(
              n.createElement(
                "div",
                { className: Z.leftco + " yh-leftcomp" },
                n.createElement(
                  "div",
                  {
                    className: "yh-left-top-wrapper",
                    style: {
                      display: "flex",
                      justifyContent: "center",
                      alignItems: "center",
                      padding: "10px",
                    },
                  },
                  n.createElement(
                    "div",
                    {
                      style: {
                        width: 120,
                        overflow: "hidden",
                        textOverflow: "ellipsis",
                        whiteSpace: "nowrap",
                        height: 32,
                        lineHeight: "32px",
                        marginRight: "10px",
                        fontSize: "14px",
                        fontFamily: "PingFangSC-Medium, PingFang SC",
                        fontWeight: 600,
                        userSelect: "none",
                      },
                    },
                    m[parseInt(o, 10)].displayName
                  ),
                  n.createElement(p, {
                    className: "yh-left-top-input",
                    style: { borderRadius: "40px" },
                    allowClear: !0,
                    value: v,
                    onChange: function (e) {
                      y(e.target.value);
                    },
                    prefix: n.createElement(u.SearchOutlined, null),
                  })
                ),
                v &&
                  "" !== v &&
                  r
                    .reduce(function (e, t) {
                      return (
                        (t.displayName.includes(v) ||
                          t.component.includes(v)) &&
                          e.push(t),
                        e
                      );
                    }, [])
                    .map(function (t, i) {
                      return n.createElement(
                        "div",
                        Object.assign(
                          {
                            className: Z.coitem + " yh-left-item-wrap",
                            key: i,
                          },
                          pe(t, e.config)
                        ),
                        n.createElement(
                          "div",
                          { className: Z.redbox + " yh-left-item-img-wrap" },
                          t.imgCustom
                            ? t.imgCustom
                            : n.createElement("img", {
                                src: t.img,
                                style: { width: "100%", height: "100%" },
                                alt: "component",
                              })
                        ),
                        n.createElement(
                          "div",
                          {
                            style: {
                              textAlign: "center",
                              lineHeight: "20px",
                              height: "20px",
                              overflow: "hidden",
                            },
                          },
                          t.displayName
                        )
                      );
                    }),
                (!v || "" === v) &&
                  r.map(function (t, i) {
                    return n.createElement(
                      "div",
                      Object.assign(
                        { className: Z.coitem + " yh-left-item-wrap", key: i },
                        pe(t, e.config)
                      ),
                      n.createElement(
                        "div",
                        { className: Z.redbox + " yh-left-item-img-wrap" },
                        t.imgCustom
                          ? t.imgCustom
                          : n.createElement("img", {
                              src: t.img,
                              style: { width: "100%", height: "100%" },
                              alt: "component",
                            })
                      ),
                      n.createElement(
                        "div",
                        {
                          style: {
                            textAlign: "center",
                            lineHeight: "20px",
                            height: "20px",
                            overflow: "hidden",
                          },
                        },
                        t.displayName
                      )
                    );
                  })
              )
            );
      },
      [o, e.config, m, v]
    );
    var x = t.useState(e.config.getCollapse()),
      b = x[0],
      w = x[1],
      M = t.useState(e.config.getCollapse()),
      E = M[0],
      C = M[1];
    return n.createElement(
      "div",
      { style: { display: "flex", height: "100%" } },
      n.createElement(
        "div",
        { style: { display: "flex", flexDirection: "column" } },
        n.createElement(
          g,
          {
            style: { flex: 1 },
            defaultSelectedKeys: [o],
            mode: "vertical",
            className: Z.menuWidth + " " + Z.menus + " yh-menu",
          },
          m.map(function (t, i) {
            return n.createElement(
              g.Item,
              {
                key: i,
                onClick: function () {
                  return r(i + "");
                },
                icon: t.icon,
                className:
                  "vertical" === e.mode
                    ? Z.menuStyle + " " + Z.menus + " yh-menuitem"
                    : "yh-menuitem",
              },
              e.showName && t.displayName
            );
          })
        ),
        n.createElement(
          "div",
          {
            className:
              Z.menu_footer + " yh-menufooter ant-menu-root ant-menu-vertical",
          },
          e.footerConfig
        ),
        n.createElement(
          g,
          { selectedKeys: [] },
          n.createElement(g.Item, {
            key: "1",
            onClick: function () {
              return w(function (t) {
                return t
                  ? (setTimeout(function () {
                      (e.config.collapsed = !1),
                        C(!1),
                        e.config.getStore().forceUpdate();
                    }, 300),
                    !t)
                  : ((e.config.collapsed = !0),
                    C(!0),
                    e.config.getStore().forceUpdate(),
                    !t);
              });
            },
            className: Z.menu_footer,
            icon: n.createElement(
              b ? u.DoubleRightOutlined : u.DoubleLeftOutlined,
              null
            ),
          })
        )
      ),
      n.createElement(
        "div",
        {
          className: Z.yhLeftrender + " ant-menu scrollbar",
          style: {
            width: b ? 0 : 270,
            paddingRight: b ? 0 : 7,
            overflowX: "hidden",
          },
        },
        !E && c
      )
    );
  }),
  (exports.LeftDataPannel = function (e) {
    var o = e.config,
      r = o.getDataCenter(),
      c = r.getDataMap(),
      s = Object.keys(c),
      l = s.map(function (e) {
        return { key: e, value: c[e] };
      }),
      u = t.useState(0)[1],
      d = t.useState(!1),
      m = d[0],
      g = d[1],
      h = t.useState(!1),
      v = h[0],
      y = h[1],
      x = t.useState({}),
      w = x[0],
      M = x[1],
      E = [
        { title: "Key", dataIndex: "key", key: "key" },
        {
          title: "操作",
          align: "center",
          render: function (t, i) {
            return n.createElement(
              I,
              { size: "middle" },
              n.createElement(
                a,
                {
                  type: "link",
                  onClick: function () {
                    var e =
                      "object" == typeof i.value
                        ? JSON.stringify(i.value)
                        : i.value;
                    D.setFieldsValue({ value: e, key: i.key }), M(i), y(!0);
                  },
                },
                "编辑"
              ),
              n.createElement(
                f,
                {
                  title: Ze("control.popup.delete", "确认删除么", o),
                  onConfirm: function () {
                    var t = K({}, c);
                    delete t[i.key],
                      r.staticSetToMap(K({}, t), e.config),
                      u(function (e) {
                        return e + 1;
                      });
                  },
                  okText: Ze("yes", "确定", o),
                  cancelText: Ze("no", "取消", o),
                },
                n.createElement(a, { type: "link" }, "删除")
              )
            );
          },
        },
      ],
      k = S.useForm()[0],
      D = S.useForm()[0];
    return n.createElement(
      "div",
      { style: { width: "100%" } },
      n.createElement(
        b,
        { style: { marginBottom: "10px" } },
        n.createElement(
          a,
          {
            type: "primary",
            onClick: function () {
              g(!0);
            },
          },
          "添加数据源"
        )
      ),
      n.createElement(
        b,
        null,
        n.createElement(N, {
          pagination: !1,
          style: { width: "100%" },
          dataSource: l,
          columns: E,
        })
      ),
      m &&
        n.createElement(
          C,
          {
            visible: m,
            title: "添加数据源",
            onCancel: function () {
              g(!1), k.resetFields();
            },
            onOk: function () {
              k.validateFields().then(function (t) {
                !(function (t) {
                  var n = t.value;
                  if (
                    (n = n.replace("/s", "").replace("↵", "")).startsWith("{")
                  )
                    try {
                      var o,
                        a = JSON.parse(n),
                        s = (((o = {})[t.key] = a), o);
                      r.staticSetToMap(K({}, c, s), e.config),
                        g(!1),
                        k.resetFields();
                    } catch (e) {
                      i.error("json格式转换失败");
                    }
                  else {
                    var l,
                      u = (((l = {})[t.key] = n), l);
                    r.staticSetToMap(K({}, c, u), e.config),
                      g(!1),
                      k.resetFields();
                  }
                })(t);
              });
            },
            okText: Ze("yes", "确定", o),
            cancelText: Ze("no", "取消", o),
          },
          n.createElement(
            "div",
            null,
            n.createElement(
              S,
              Object.assign({ form: k }, jt),
              n.createElement(
                S.Item,
                {
                  label: "key",
                  name: "key",
                  rules: [
                    { required: !0, message: "Please input your key" },
                    function () {
                      return {
                        validator: function (e, t) {
                          return s.includes(t)
                            ? Promise.reject(new Error("Duplicate  keys!"))
                            : Promise.resolve();
                        },
                      };
                    },
                    function () {
                      return {
                        validator: function (e, t) {
                          return Pt.exec(t)
                            ? Promise.reject(new Error("invalid key"))
                            : Promise.resolve();
                        },
                      };
                    },
                  ],
                },
                n.createElement(p, null)
              ),
              n.createElement(
                S.Item,
                {
                  label: "value",
                  name: "value",
                  extra: n.createElement(
                    Yt,
                    { type: "warning" },
                    "支持字符串、数字、JSON对象格式，直接输入内容即可"
                  ),
                  rules: [{ required: !0, message: "Please input your value" }],
                },
                n.createElement(p.TextArea, null)
              )
            )
          )
        ),
      v &&
        n.createElement(
          C,
          {
            visible: v,
            title: "修改数据源",
            onCancel: function () {
              y(!1), D.resetFields();
            },
            onOk: function () {
              D.validateFields().then(function (t) {
                var n = t.value;
                if ((n = n.replace("/s", "").replace("↵", "")).startsWith("{"))
                  try {
                    var o,
                      a = JSON.parse(n),
                      s = (((o = {})[w.key] = a), o);
                    r.staticSetToMap(K({}, c, s), e.config),
                      y(!1),
                      D.resetFields();
                  } catch (e) {
                    i.error("json格式转换失败");
                  }
                else {
                  var l,
                    u = (((l = {})[w.key] = n), l);
                  r.staticSetToMap(K({}, c, u), e.config),
                    y(!1),
                    D.resetFields();
                }
              });
            },
            okText: Ze("yes", "确定", o),
            cancelText: Ze("no", "取消", o),
          },
          n.createElement(
            S,
            { form: D },
            n.createElement(
              S.Item,
              {
                label: "value",
                name: "value",
                extra: n.createElement(
                  Yt,
                  { type: "warning" },
                  "支持字符串、数字、JSON对象格式，直接输入内容即可"
                ),
                rules: [{ required: !0, message: "Please input your value" }],
              },
              n.createElement(p.TextArea, null)
            )
          )
        )
    );
  }),
  (exports.Preview = function (e) {
    var i = e.config.getStore().isEdit(),
      o = t.useState(!0),
      r = o[0],
      a = o[1];
    if (
      (t.useEffect(
        function () {
          var t = function () {
              e.config.created(),
                e.config.createdFn.forEach(function (e) {
                  return e();
                }),
                setTimeout(function () {
                  e.config
                    .getDataCenter()
                    .initAddToDataMap(e.config.getStore().getData()),
                    e.config
                      .getEventCenter()
                      .syncEventMap(
                        e.config.getStore().getData(),
                        e.config.getStore()
                      );
                  var t = e.config.getStore().getData().globalState,
                    n = null == t ? void 0 : t.bodyColor,
                    i = null == t ? void 0 : t.title;
                  i && (document.title = i),
                    n && (document.body.style.backgroundColor = n);
                  var o = null == t ? void 0 : t.customAnimate;
                  o &&
                    Array.isArray(o) &&
                    e.config.animateFactory.fromArrInsertKeyFrame(o),
                    e.completeFn && e.completeFn(),
                    e.config.beforeOnMounted(),
                    e.config.beforeOnMountedFn.forEach(function (e) {
                      return e();
                    }),
                    void 0 === e.loadingState && a(!1);
                });
            },
            n = e.config.getStore().getData().globalState.script;
          n && Array.isArray(n) && n.length > 0
            ? (function () {
                var i = W(
                  He.mark(function i() {
                    var o, r, a;
                    return He.wrap(
                      function (i) {
                        for (;;)
                          switch ((i.prev = i.next)) {
                            case 0:
                              (o = n.map(function (t) {
                                return function () {
                                  return new Promise(function (n) {
                                    var i = document.createElement("script");
                                    (i.src = t),
                                      document.body.appendChild(i),
                                      (i.onload = function () {
                                        var o =
                                          window[e.config.SCRIPTGLOBALNAME];
                                        try {
                                          e.config.registComponent(o);
                                        } catch (e) {
                                          console.error("read item fail:", t);
                                        }
                                        document.body.removeChild(i), n(0);
                                      });
                                  });
                                };
                              })),
                                (r = o.length),
                                (a = 0);
                            case 3:
                              if (!(a < r)) {
                                i.next = 15;
                                break;
                              }
                              return (i.prev = 4), (i.next = 7), o[a]();
                            case 7:
                              i.next = 12;
                              break;
                            case 9:
                              (i.prev = 9),
                                (i.t0 = i.catch(4)),
                                console.error("script load fail:", n[a]);
                            case 12:
                              a++, (i.next = 3);
                              break;
                            case 15:
                              t();
                            case 16:
                            case "end":
                              return i.stop();
                          }
                      },
                      i,
                      null,
                      [[4, 9]]
                    );
                  })
                );
                return function () {
                  return i.apply(this, arguments);
                };
              })()()
            : t();
        },
        [e, e.config]
      ),
      i)
    ) {
      var c = e.config.getStore(),
        s = c.getData();
      return (
        c.changeModaltoNormal(s),
        n.createElement(
          n.Fragment,
          null,
          n.createElement(Ct, {
            config: e.config,
            context: "preview",
            state: c.getData(),
          })
        )
      );
    }
    var l = n.createElement("div", null, e.loadText ? e.loadText : "loading"),
      u = n.createElement(
        n.Fragment,
        null,
        n.createElement(Ct, {
          config: e.config,
          context: "preview",
          state: e.config.getStore().getData(),
          previewContainerStyle: e.previewContainerStyle,
        })
      );
    return void 0 === e.loadingState ? (r ? l : u) : e.loadingState ? l : u;
  }),
  (exports.RightConfig = function (e) {
    var i = t.useState("0"),
      o = i[0],
      a = i[1],
      c = t.useState(null),
      s = c[0],
      l = c[1],
      u = t.useMemo(
        function () {
          return e.config.getConfig().rightRenderListCategory;
        },
        [e.config]
      ),
      f = e.config.getStore();
    t.useEffect(
      function () {
        var e = f.subscribe(function () {
          var e;
          f.getData().block.some(function (t) {
            return t.focus && (e = t), !0 === t.focus;
          }),
            l(e ? K({}, e) : null);
        });
        return function () {
          e();
        };
      },
      [f]
    );
    var d = t.useMemo(
        function () {
          return function (t, i) {
            var o = e.config.getComponentRegister().getComp(i.name);
            if (o) {
              var r = o.props[t];
              return r
                ? r.map(function (t, o) {
                    var r = e.config.getFormRegister().formMap[t.type];
                    return r
                      ? n.createElement(r, {
                          key: o,
                          data: t,
                          current: i,
                          config: e.config,
                        })
                      : (console.error(
                          "you might forgot to regist form component " + t.type
                        ),
                        null);
                  })
                : n.createElement(
                    "div",
                    {
                      className: "yh-right-noprops",
                      style: { textAlign: "center" },
                    },
                    Ze("right.noprops", "还没有配置属性", e.config)
                  );
            }
            return null;
          };
        },
        [e.config]
      ),
      m = t.useMemo(
        function () {
          return O(e.config.getStore().getData().globalState.containerColor);
        },
        [e.config]
      ),
      g = t.useMemo(
        function () {
          return e.config.getStore().getData().globalState.title;
        },
        [e.config]
      ),
      M = t.useMemo(
        function () {
          return e.config.getStore().getData().globalState.description;
        },
        [e.config]
      ),
      E = t.useState(g),
      C = E[0],
      S = E[1],
      k = t.useState(M),
      D = k[0],
      N = k[1],
      I = e.config.getConfig().rightGlobalCustom,
      L = e.config.getStore().isEdit(),
      F = e.config.getStore().getData(),
      R = F.modalEditName;
    return n.createElement(
      "div",
      {
        className: "ant-menu right-pannel-wrap",
        style: {
          height: "100%",
          width: "400px",
          overflow: "auto",
          padding: "0 10px",
          lineHeight: 1.5715,
        },
      },
      s &&
        n.createElement(
          w,
          {
            activeKey: o,
            style: { width: "100%" },
            onChange: function (e) {
              a(e);
            },
          },
          u.map(function (t, i) {
            return n.createElement(
              w.TabPane,
              { tab: t.icon, key: i + "" },
              n.createElement(
                "div",
                {
                  className: "scrollbar right-pannel-tabdiv",
                  style: {
                    height: "calc(100vh - 110px)",
                    overflow: "auto",
                    position: "fixed",
                    width: 380,
                  },
                },
                t.custom &&
                  t.customRender &&
                  t.customRender(t.type, s, e.config),
                !t.custom && d(t.type, s)
              )
            );
          })
        ),
      !s &&
        !L &&
        !I &&
        n.createElement(
          "div",
          { style: { padding: "10px" } },
          n.createElement(
            b,
            {
              style: {
                padding: "10px 0 20px 0",
                fontWeight: "bold",
                userSelect: "none",
              },
            },
            Ze("right.global", "全局设置", e.config)
          ),
          n.createElement(
            b,
            { style: { padding: "10px 0" } },
            n.createElement(
              x,
              { span: 6, style: K({}, Nt) },
              Ze("title", "标题", e.config)
            ),
            n.createElement(
              x,
              { span: 18, style: Dt },
              n.createElement(p, {
                value: C,
                onChange: function (t) {
                  var n = t.target.value;
                  S(n);
                  var i = r(e.config.getStore().getData());
                  (i.globalState.title = n), e.config.getStore().setData(i);
                },
              })
            )
          ),
          n.createElement(
            b,
            { style: { padding: "10px 0" } },
            n.createElement(
              x,
              { span: 6, style: K({}, Nt) },
              Ze("description", "描述", e.config)
            ),
            n.createElement(
              x,
              { span: 18, style: Dt },
              n.createElement(p, {
                value: D,
                onChange: function (t) {
                  var n = t.target.value;
                  N(n);
                  var i = r(e.config.getStore().getData());
                  (i.globalState.description = n),
                    e.config.getStore().setData(i);
                },
              })
            )
          ),
          n.createElement(
            b,
            { style: { padding: "10px 0" } },
            n.createElement(
              x,
              { span: 6, style: K({}, Nt) },
              Ze("right.containerwidth", "容器宽度", e.config)
            ),
            n.createElement(
              x,
              { span: 18, style: Dt },
              n.createElement(y, {
                min: 0,
                disabled: !0,
                value: e.config.getStore().getData().container.width,
                onChange: function (t) {
                  var n = t,
                    i = r(e.config.getStore().getData());
                  (i.container.width = n), e.config.getStore().setData(i);
                },
              })
            )
          ),
          n.createElement(
            b,
            { style: { padding: "10px 0" } },
            n.createElement(
              x,
              { span: 6, style: K({}, Nt) },
              Ze("right.containerheight", "容器高度", e.config)
            ),
            n.createElement(
              x,
              { span: 18, style: Dt },
              n.createElement(y, {
                min: 0,
                value: e.config.getStore().getData().container.height,
                onChange: function (t) {
                  var n = t,
                    i = r(e.config.getStore().getData());
                  (i.container.height = n), e.config.getStore().setData(i);
                },
              })
            )
          ),
          n.createElement(
            b,
            { style: { padding: "10px 0" } },
            n.createElement(
              x,
              { span: 6, style: K({}, Nt) },
              Ze("right.containerColor", "容器底色", e.config)
            ),
            n.createElement(
              x,
              { span: 18, style: Dt },
              n.createElement(kt, {
                initColor: m,
                onChange: function (t) {
                  var n = r(e.config.getStore().getData());
                  (n.globalState.containerColor =
                    "rgba(" + t.r + ", " + t.g + ", " + t.b + ", " + t.a + ")"),
                    e.config.getStore().setData(n);
                },
              })
            )
          ),
          n.createElement(
            b,
            { style: { padding: "10px 0" } },
            n.createElement(x, { span: 6, style: K({}, Nt) }, "小程序"),
            n.createElement(
              x,
              { span: 18, style: Dt },
              n.createElement(v, {
                checked: e.config.getStore().getData().container.isMinwx,
                onChange: function (t) {
                  var n = t,
                    i = r(e.config.getStore().getData());
                  (i.container.isMinwx = n), e.config.getStore().setData(i);
                },
              })
            )
          ),
          e.globalExtra && e.globalExtra
        ),
      !s && !L && I && I(e.config),
      !s &&
        L &&
        n.createElement(
          "div",
          { style: { padding: "10px" }, className: "yh-tcsz" },
          n.createElement(
            b,
            { style: { padding: "10px 0 20px 0", fontWeight: "bold" } },
            Ze("modal.control", "弹窗配置", e.config)
          ),
          n.createElement(
            b,
            { style: { padding: "10px 0" } },
            n.createElement(
              x,
              { span: 8, style: K({}, Nt) },
              Ze("modal.control.remove", "取消点击删除弹窗", e.config)
            ),
            n.createElement(
              x,
              { span: 16, style: K({}, Dt) },
              n.createElement(h, {
                checked: F.modalConfig[R] || !1,
                onChange: function (t) {
                  var n = t.target.checked,
                    i = r(F);
                  (i.modalConfig[R] = n), e.config.getStore().setData(i);
                },
              })
            )
          ),
          e.modalExtra && e.modalExtra
        )
    );
  }),
  (exports.UserConfig = sn),
  (exports.arrayMove = T),
  (exports.changeUserValue = function (e, t, n, i, o) {
    var r = t[n];
    switch (e) {
      case "ctx":
        return Array.isArray(r)
          ? r.reduce(function (e, t) {
              return e.push(o[t]), e;
            }, [])
          : [];
      case "dataSource":
        var a = i.getDataCenter().getDataMap();
        return Array.isArray(r)
          ? r.reduce(function (e, t) {
              return e.push(a[t]), e;
            }, [])
          : [];
      default:
        return Array.isArray(r) ? r : [];
    }
  }),
  (exports.changeUserValueRecord = function (e, t, n, i, o) {
    var r = t[n];
    switch (e) {
      case "ctx":
        return Array.isArray(r)
          ? r.reduce(function (e, t) {
              var n;
              return Object.assign(e, (((n = {})[t] = o[t]), n));
            }, {})
          : {};
      case "dataSource":
        var a = i.getDataCenter().getDataMap();
        return Array.isArray(r)
          ? r.reduce(function (e, t) {
              var n;
              return Object.assign(e, (((n = {})[t] = a[t]), n));
            }, {})
          : {};
      default:
        return Array.isArray(r)
          ? r.reduce(function (e, t) {
              var n;
              return Object.assign(e, (((n = {})[t] = t), n));
            }, {})
          : {};
    }
  }),
  (exports.createPannelOptions = function (e, t) {
    return { type: e, option: t };
  }),
  (exports.createUid = A),
  (exports.deepCopy = _),
  (exports.defaultStore = rn),
  (exports.dragEventResolve = pe),
  (exports.focusState = $t),
  (exports.innerContainerDragUp = function (e) {
    var t = e.getStore();
    return {
      onMouseUp: function (n) {
        if (
          ((Ye.cache = null),
          (Ye.sortLeft = null),
          (Ye.sortTop = null),
          (Ye.sortRight = null),
          (Ye.sortBottom = null),
          (function (e) {
            Ae.ref &&
              Ae.ref.current &&
              (Ae.ref.current.style.cursor = "default"),
              Re(e),
              (Oe.isDrag = !1);
          })(e),
          lt(e).onMouseUp(),
          (function (e) {
            Re(e), (_e.isDrag = !1);
          })(e),
          ae(n, e),
          Q.ref && Q.ref.current && (Q.ref.current.style.willChange = "auto"),
          Se(e),
          (function (e) {
            (Xe.isRotate = !1), (Xe.item = null);
            var t = e.getStore();
            if (Xe.current) {
              var n = t.getIndex();
              t.getStoreList().splice(Xe.current, n - Xe.current),
                t.setIndex(Xe.current);
            }
            Xe.current = 0;
          })(e),
          Q.current)
        ) {
          var i = t.getIndex();
          t.getStoreList().splice(Q.current, i - Q.current),
            t.setIndex(Q.current);
        }
        (Q.ref = null),
          (Q.isDrag = !1),
          (Q.item = null),
          (Q.current = 0),
          (ve.marklineUnfocus = null),
          t.forceupdate();
      },
      onMouseMove: function (t) {
        lt(e).onMouseMove(t);
      },
    };
  }),
  (exports.locale = $e),
  (exports.postMessage = P),
  (exports.rgba2Obj = O),
  (exports.scaleFn = Lt),
  (exports.specialCoList = F),
  (exports.specialFnList = R),
  (exports.swap = function (e, t, n) {
    return (n[e] = n.splice(t, 1, n[e])[0]), n;
  }),
  (exports.unmountContextMenu = le),
  (exports.useDynamicAddEventCenter = function (e, n, i) {
    var o = t.useMemo(
      function () {
        return e.config.getEventCenter();
      },
      [e.config]
    );
    t.useEffect(
      function () {
        var t = e.store.getData(),
          r = e.data.eventMap,
          a = t.block.find(function (t) {
            return t.id === e.data.id;
          });
        a &&
          (r[n] ||
            ((a.eventMap[n] = { arr: [], displayName: i, userSelect: [] }),
            o.manualUpdateMap(n, i)));
      },
      [i, o, n, e.data.eventMap, e.data.id, e.store]
    );
  }),
  (exports.useIframeHook = function (e, n) {
    var i = t.useState(!1),
      o = i[1],
      r = B(e, n, i[0])[0];
    t.useEffect(
      function () {
        var e = function (e) {
          "ready" === e.data && (o(!0), r()),
            "object" == typeof e.data &&
              "update" === e.data.type &&
              "scale" === e.data.column &&
              ((n.scaleState = e.data.data),
              n.getStore().forceUpdate(),
              n.refreshIframe());
        };
        return (
          window.addEventListener("message", e),
          function () {
            window.removeEventListener("message", e);
          }
        );
      },
      [n, r]
    );
  }),
  (exports.useIframePostMessage = B),
  (exports.useRegistFunc = function (e, n, i) {
    t.useEffect(
      function () {
        var t = function () {};
        return (
          e && (t = i),
          function () {
            "preview" === n && t();
          }
        );
      },
      [n, e, i]
    );
  }),
  (exports.useStoreState = function (e, n, i) {
    void 0 === n && (n = function () {}), void 0 === i && (i = function () {});
    var o = e.getStore(),
      r = t.useState(o.getData()),
      a = r[0],
      c = r[1],
      s = t.useState(0)[1];
    return (
      t.useEffect(
        function () {
          var t = o.subscribe(function () {
            var t = o.getData();
            c(t),
              e.getEventCenter().syncEventMap(o.getData(), e.getStore()),
              e.getEventCenter().getFunctionCenter().syncFunction(o),
              n();
          });
          o.setForceUpdate(function () {
            return s(function (e) {
              return e + 1;
            });
          });
          var i = e.getConfig().initCommandModule,
            r = e.getCommanderRegister();
          return (
            (function (e, t) {
              e.forEach(function (e) {
                t.register(e);
              });
            })(i, r),
            function () {
              t(),
                (function (e, t) {
                  e.forEach(function (e) {
                    t.unRegister(e.name);
                  });
                })(i, r);
            }
          );
        },
        [e, n, s, o]
      ),
      t.useEffect(
        function () {
          i();
        },
        [i]
      ),
      t.useEffect(function () {
        var e = function (e) {
            (!0 === e.ctrlKey || e.metaKey) && e.preventDefault();
          },
          t = function (e) {
            (!0 === e.ctrlKey || e.metaKey) && e.preventDefault();
          };
        return (
          window.addEventListener("mousewheel", e, { passive: !1 }),
          window.addEventListener("DOMMouseScroll", t, { passive: !1 }),
          function () {
            window.removeEventListener("mousewheel", e),
              window.removeEventListener("mousewheel", t);
          }
        );
      }, []),
      [a]
    );
  }),
  (exports.userConfigMerge = cn);
//# sourceMappingURL=lowcode-lib.cjs.production.min.js.map
